<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-06-25 Wed 13:42 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kernel Collocation Excercise</title>
<meta name="author" content="Jonathan Ulmer (3545737)" />
<meta name="generator" content="Org Mode" />
<style type='text/css'>
<!--/*--><![CDATA[/*><!--*/
/* nice-org-html.css
;;==============================================================================
;; Copyright (C) 2024, Ewan Townshend

;; Author: Ewan Townshend
;; URL: https://github.com/ewantown/nice-org-html
;; Version: 1.2

;;==============================================================================
;; This program is free software; you can redistribute it and/or modify
;; it under the terms of the GNU General Public License as published by
;; the Free Software Foundation, either version 3 of the License, or
;; (at your option) any later version.

;; This program is distributed in the hope that it will be useful,
;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;; GNU General Public License for more details.

;; You should have received a copy of the GNU General Public License
;; along with this program.  If not, see <https://www.gnu.org/licenses/>.

;; This file is not part of emacs.

;;==============================================================================
*/

/* basic layout ***************************************************************/
*,
*::before,
*::after {
    box-sizing: border-box;
}
html {
    font-family: Sans;
    line-height: 1.3;
    font-size: calc(15px + 0.390625vw);
    -webkit-text-size-adjust: 100%;
}

body {
    background: #999; /* overwritten with theme --bg */
    width: 100%;
    min-height: 100vh;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family:
	-apple-system,
	BlinkMacSystemFont,
	segoe ui,
	Roboto,
	Oxygen,
	Ubuntu,
	Cantarell,
	open sans,
	helvetica neue,
	sans-serif,
	system-ui
}

#preamble,
#postamble {
    width: 100%;
}

#content {
    width: 80%;
    max-width: 80ch;
    margin-left: 1rem;
    margin-right: 1rem;
    flex: 1;
}

/* custom facing **************************************************************/
/* The variable values are injected by CSS pre-processing in et-org-html.el */
:root {
    --bc-tb: #282a2e;
    --bc-block: #c5c8c6;
    --clr: #282a2e;
    --clr-tb-hd: #282a2e;
    --clr-code: #282a2e;
    --bg: #ffffff;
    --bg-code: #cecece;
    --bg-tb-hd: #cecece;
    --bg-block: #f3f3f3;
    --clr-link: #969896;
    --clr-title: #282a2e;
    --clr-todo: #969896;
    --bg-todo: initial;
    --clr-done: #c5c8c6;
    --bg-done: initial;
    --ts-clr: #282a2e;
    --mg: 20px;
    --w-toc: 300px;
    --bg-keyword: initial;
    --clr-keyword: #282a2e;
    --bg-constant: initial;
    --clr-constant: #969896;
    --bg-comment: initial;
    --clr-comment: #c5c8c6;
    --bg-comment-delimiter: initial;
    --clr-comment-delimiter: initial;
    --bg-function: initial;
    --clr-function: #282a2e;
    --bg-variable: initial;
    --clr-variable: #969896;
    --bg-preprocessor: initial;
    --clr-preprocessor: #282a2e;
    --bg-doc: initial;
    --clr-doc: #c5c8c6;
    --bg-builtin: initial;
    --clr-builtin: #969896;
    --bg-string: initial;
    --clr-string: #969896;
    --clr-note: #0969da;
    --clr-tip: #1a7f37;
    --clr-important: #8250df;
    --clr-warning: #9a6700;
    --clr-caution: #cf222e;
}

body[data-mode='light'] {
    background: var(--bg);
    color: var(--clr);
}

body[data-mode='dark'] {
    background: var(--bg);
    color: var(--clr);
    --bc-tb: #c5c8c6;
    --bc-block: #717171;
    --clr: #c5c8c6;
    --clr-code: #ffffff;
    --clr-tb-hd: #ffffff;
    --bg: #1d1f21;
    --bg-tb-hd: #0f1011;
    --bg-code: #0f1011;
    --bg-block: #292b2b;
    --clr-link: #de935f;
    --clr-title: #c5c8c6;
    --clr-todo: #b5bd68;
    --bg-todo: initial;
    --clr-done: #5a5b5a;
    --bg-done: initial;
    --ts-clr: #b294bb;
    --mg: 20px;
    --w-toc: 300px;
    --bg-keyword: initial;
    --clr-keyword: #b294bb;
    --bg-constant: initial;
    --clr-constant: #de935f;
    --bg-comment: initial;
    --clr-comment: #5a5b5a;
    --bg-comment-delimiter: initial;
    --clr-comment-delimiter: initial;
    --bg-function: initial;
    --clr-function: #81a2be;
    --bg-variable: initial;
    --clr-variable: #cc6666;
    --bg-preprocessor: initial;
    --clr-preprocessor: #c5c8c6;
    --bg-doc: initial;
    --clr-doc: #717171;
    --bg-builtin: initial;
    --clr-builtin: #81a2be;
    --bg-string: initial;
    --clr-string: #b5bd68;
    --clr-note: #0969da;
    --clr-tip: #1a7f37;
    --clr-important: #8250df;
    --clr-warning: #9a6700;
    --clr-caution: #cf222e;
}

/* exceptions for badly rendering themes **************************************/
body[data-theme='leuven'],
body[data-theme='leuven-dark'] {
    --bg-code: var(--bg-block);
}

/* ootb page layout ***********************************************************/
#view-controls {
    position: sticky;
    display: flex;
    align-items: center;
    justify-content: center;
    top: 0;
    left: 0;
    width: 100%;
    background: var(--bg);
    color: var(--clr-code);
    height: 2.5rem;
    padding-top: 1.25rem;
    padding-bottom: 1.25rem;
    z-index: 100;
    border-radius: 5px; /* Rounded corners */
}
#toggle-mode {
    position: absolute;
    right: 5%;
    display: block;
    text-align: center;
    font-size: 1.5rem;
    background: var(--bg);
    color: var(--clr-code);
    padding: 0.25rem 0;
}
#goto-top {
    display: none;
}
#goto-top[data-show="true"] {
    position: relative;
    display: block;
    text-align: center;
    font-size: 1rem;
    background: var(--bg);
    color: var(--clr-code);
    padding: 0.25rem 0;
}
#toggle-toc {
    display: none;
}
#toggle-toc[data-show="true"] {
    position: absolute;
    left: 5%;
    display: block;
    text-align: center;
    font-size: 1.5rem;
    background: var(--bg);
    color: var(--clr-code);
    padding: 0.25rem 0;
}

#toggle-toc:hover,
#goto-top:hover,
#toggle-mode:hover {
    cursor: pointer;
}

#table-of-contents {
    display: none;
}
#table-of-contents[data-show="true"] {
    width: 80%;
    max-width: 80rem;
    margin-left: 1rem;
    margin-right: 1rem;
    background: var(--bg);
    scrollbar-width: none;
    -ms-overflow-style: none;
}

#table-of-contents::-webkit-scrollbar {
    display: none;
}

body[data-toc="true"] #content * {
    display: none;
}
body[data-toc="true"] #content #table-of-contents,
body[data-toc="true"] #content #table-of-contents * {
    display: block;
}


/* misc elements **************************************************************/

hr {
    height: 0;
    color: inherit;
}

b,
strong {
    font-weight: bolder;
}

code,
kbd,
samp,
pre {
    font-family:
	Menlo,
	ui-monospace,
	SFMono-Regular,
	Consolas,
	'Liberation Mono',
	monospace;
}

small {
    font-size: 80%;
}

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sub {
    bottom: -0.25em;
}

sup {
    top: -0.5em;
}

table {
    text-indent: 0;
    border-color: inherit;
}

summary {
    display: list-item;
}

h1 {
    color: var(--clr-title);
    text-align: center;
}
h2 {
    margin-top: 2rem;
    margin-bottom: 1rem;
}

code {
    color: var(--clr-code);
    background: var(--bg-code);
    border-radius: 2px;
    padding-left: 5px;
    padding-right: 5px;
}

pre::-webkit-scrollbar {
    display: none;
}

.todo {
    color: var(--clr-todo);
    background: var(--bg-todo);
}

.done {
    color: var(--clr-done);
    background: var(--bg-done);
}

.timestamp-wrapper {
    font-size: 0.8rem;
    color: var(--clr-ts);
}

table {
    width: 100%;
    border: 2px solid var(--bc-tb);
}

thead {
    color: var(--clr-tb-hd);
    background: var(--bg-tb-hd);
}

td, th {
    border: thin solid var(--bc-tb);
}

li {
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
}
#text-table-of-contents li a:before {
    content: "• "
}

a {
    text-decoration: none;
    color: var(--clr-link);
}

a:hover {
    text-decoration: underline;
}

.MathJax_Display {
    font-size: 1.25em;
}

img {
    max-width: 100%;
}

pre {
    padding: 1rem;
    border: 1px solid var(--bc-block);
    border-radius: 0.5rem;
    background: var(--bg-block);
    font-size: 0.9rem;
    overflow-x: auto;
    -ms-overflow-style: none;
    scrollbar-width: thin;
}

.org-src-wrapper {
    position: relative;
    border: 1px solid var(--bc-block);
    border-radius: 0.5rem;
    background: var(--bg-code);
}

.org-src-bar {
    position: relative;
    top: 0rem;
    width: 100%;
    background: var(--bg-code);
    border-radius: 0.5rem;
    text-align: right;
    min-height: 1rem;
}

.org-src-wrapper .org-src-container {
    position: relative;
    border: none;
    border-radius: 0.5rem;
    background: var(--bg-code);
    z-index: 0;
}

.org-src-wrapper .org-src-container pre.src {
    border: none !important;
    background: var(--bg-code) !important;
    padding-top: 0rem;
    padding-bottom: 0rem;
    margin-top: 0rem;
    margin-bottom: 0rem;
    padding-bottom: 1.6rem;
}

.org-src-wrapper .org-src-bar .srcLangLabel {
    top: 0rem;
    right: 1.6rem;
    background-color: transparent;
    color: var(--clr-doc);
    border: none;
    padding: 0.5rem;
    padding-bottom: 0.3rem;
    text-align: center;
    text-decoration: none;
    font-size: 0.8rem;
    opacity: 0.5;
    z-index: 1;
    display: none;
}

.org-src-wrapper .org-src-bar .copyBtn {
    top: 0rem;
    right: 0.1rem;
    background-color: transparent;
    color: var(--clr-doc);
    border: none;
    padding: 0.5rem;
    padding-right: 0.7rem;
    padding-bottom: 0.3rem;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 0.8rem;
    cursor: pointer;
    opacity: 0.5;
    z-index: 1;
    transition: opacity 0.3s;
}

.org-src-wrapper .copyBtn:hover {
    opacity: 1;
}

.org-src-wrapper .copyBtn i {
    margin-right: 0.5rem;
    padding: 0.5rem;
}

.admonition {
    margin: 0.2rem;
    color: inherit;
    border-left: .25rem solid;
}
.admonition-title {
    margin: 0 0 0.5rem 0.5rem;
    padding: 0.5rem 0 0 0;
    display: flex;
    align-items: center;
}
.admonition-content > p {
    margin: 0.5rem 0 0 0.5rem;
    padding: 0 0 0.5rem 0;
}

.admonition.note {
    border-left-color: var(--clr-note);
}
.admonition-title.note {
    color: var(--clr-note);
}
.admonition-title.note:before {
    content: '';
    display: inline-block;
    margin-right: 0.5rem;
    width: 1rem;
    height: 1rem;
    background-color: var(--clr-note);
    mask-size: cover;    
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="false"><path class="admonition-icon-note" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>');    
}
.admonition-icon-note {
    fill: var(--clr-note);
}

.admonition.tip {
    border-left-color: var(--clr-tip);
}
.admonition-title.tip {
    color: var(--clr-tip);
}
.admonition-title.tip:before {
    content: '';
    fill: var(--clr-tip);    
    display: inline-block;
    margin-right: 0.5rem;
    width: 1rem;
    height: 1rem;
    background-color: var(--clr-tip);
    mask-size: cover;
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="false"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>');    
}

.admonition.important {
    border-left-color: var(--clr-important);
}
.admonition-title.important {
    color: var(--clr-important);
}
.admonition-title.important:before {
    content: '';
    fill: var(--clr-important);    
    display: inline-block;
    margin-right: 0.5rem;
    width: 1rem;
    height: 1rem;
    background-color: var(--clr-important);
    mask-size: cover;
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="false"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>');    
}

.admonition.warning {
    border-left-color: var(--clr-warning);
}
.admonition-title.warning {
    color: var(--clr-warning);
}
.admonition-title.warning:before {
    content: '';
    color: var(--clr-warning);    
    display: inline-block;
    margin-right: 0.5rem;
    width: 1rem;
    height: 1rem;
    background-color: var(--clr-warning);
    mask-size: cover;
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="false"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>');
}


.admonition.caution {
    border-left-color: var(--clr-caution);
}
.admonition-title.caution {
    color: var(--clr-caution);
}
.admonition-title.caution:before {
    content: '';
    fill: var(--clr-caution);    
    display: inline-block;
    margin-right: 0.5rem;
    width: 1rem;
    height: 1rem;
    background-color: var(--clr-caution);
    mask-size: cover;
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="false"><path d="M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>');    
}
/* responsive layouts *********************************************************/

@media only screen and (max-width: 768px) {
    #toggle-toc[data-show='true'] {
	padding-right: 5%;
    }
    #toggle-mode {
	padding-left: 5%;
    }
    #content {
	width: 90%;
    }
}

@media only screen and (max-width: 480px) {
    #view-controls {
	padding-top: 1.5em;
	padding-bottom: 1.5em;
    }
    #toggle-toc[data-show='true'] {
	padding-right: 5%;
    }
    #toggle-mode {
	padding-left: 5%;
    }
    #content {
	width: 90%;
    }
}


/* generated header and footer ************************************************/

#generated-header,
#generated-footer {
    width: 90%;
    margin-left: 5%;
    margin-right: 5%;
    line-height: 1;
}
.generated header {
    top: 0;
    left: 0;
}
.generated footer {
    bottom: 0;
    left: 0;
}
.generated header a,
.generated footer a {
    display: inline;
    color: var(--clr-title);
    text-decoration: none;
    transition: color .15s ease-in;
}
.generated header a:hover,
.generated footer a:hover {
    color: var(--clr-link);
}

.generated header nav {
    position: relative;
    margin-top: 1rem;
    top: 0;
    left: 0;
}
.generated footer nav {
    position: relative;
    bottom: 0;
    left: 0;
}

.generated .separator {
    display: block;
    width: 111%;
    margin-left: -5.5%;
    max-width: 100vw;
    height: 0.125rem;
    background: var(--bg-code);
}

.generated a .nav-title,
.generated a .nav-author {
    display: inline;
    margin-top: 1rem;
    margin-bottom: 1rem;
    padding-right: 10rem;
}

.generated .nav-title {
    letter-spacing: .075rem;
    font-weight: 500;
}

.generated .nav-toggle {
    display: none;
}
.generated .nav-button {
    display: none;
}
.generated .nav-list {
    overflow-y: hidden;
    display: block;
    float: right;
    list-style: none;
    margin-bottom: 0;
    margin-top: 0;
}

.generated .nav-item {
    position: relative;
    float: left;
    margin: 0;
}
.generated .nav-link {
    position: relative;
    float: right;
    margin-left: 2rem;
    margin-right: 0rem;
}

.generated .nav-toggle {
    max-height: 0;
    visibility: hidden;
    overflow-y: hidden;
}

.generated header .separator {
    margin-top: 1rem;
    margin-bottom: 0;
}

.generated footer .separator {
    margin-bottom: 1rem;
    margin-top: 0;
}

.generated .menu-sep {
    display: none;
    max-height: 0;
    overflow-y: hidden;
    transition: max-height 0.2s ease;
}

.generated footer {
    padding-bottom: 1rem;
}

.generated.compact footer {
    padding-bottom: 0;
}

.generated.compact header .separator {
    margin-top: 0;
    margin-bottom:0;
}
.generated.compact footer .separator {
    margin-bottom: 1rem;
}

.generated.compact .nav-toggle {
    visibility: visible;
}

.generated.compact .nav-toggle + label span::before {
    transition: all 0.2s ease-in;
}
.generated.compact .nav-toggle:checked + label span::before {
    transform: translateX(0.04rem) translateY(-0.25rem) rotate(90deg);
    transition: all 0.2s ease;
}

.generated.compact .menu-sep {
    display: flex;
    max-height: 0rem;
}
.generated.compact .nav-toggle:checked + label + .menu-sep {
    display: block;
    position: relative;
    max-height: 1rem;
    transition: max-height 0.2s ease;
}

.generated.compact .nav-list {
    float: none !important;
    position: relative;
    display: block;
    padding-left: 0;
    padding-right: 0;
    z-index: 5;
    width: 100%;
    height: auto;
    max-height: 0;
    margin: 0;
    overflow-x: hidden;
    overflow-y: hidden;
    transition: max-height 0.2s ease;
}
.generated.compact .nav-toggle:checked + label ~ .nav-list {
    display: block;
    max-height: 100rem;
    overflow-y: hidden;
}
.generated.compact header .nav-toggle:checked + label ~ .nav-list {
    transition: max-height 0.2s ease;
}

.generated.compact .nav-button {
    display: inline;
    position: relative;
    float: right;
    font-size: 1rem;
}
.generated.compact .nav-button span::before {
    display: inline-block;
    content: '\2807';
    font-size: 2rem;
    transform: translateX(0.25rem) translateY(-0.5rem);
}

.generated.compact .nav-item {
    float: none !important;
    text-align: center !important;
}
.generated.compact .nav-link {
    line-height: 2rem;
    margin-left: 2rem;
    margin-right: 2rem;
    float: none !important;
}

.generated.compact footer .separator.menu-sep {
    margin-bottom: -1rem;
}

.hidden {
    display: none;
}

.collapsible:hover {
    cursor: pointer;
}

.collapsible.collapsed::after {
    display: inline-block;
    content: '...';
}
/*]]>*/-->
</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="preamble" class="status">
<div id='view-controls'><div id='toggle-mode' title='Mode'>&#9788;</div><div id='goto-top' title='Top'>&#8963;</div><div id='toggle-toc' title='Contents'>&#9776;</div></div>
</div>
<div id="content" class="content">
<h1 class="title">Kernel Collocation Excercise</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org9cb0a95">1. Projection Approach</a>
<ul>
<li><a href="#org6bd8cd1">1.1. right hand side</a></li>
<li><a href="#orgc385bc2">1.2. Kernel Matrix for evaluation</a></li>
</ul>
</li>
<li><a href="#orge8bc26d">2. Solver</a></li>
<li><a href="#org5bdcfd8">3. Kernel Implementation</a>
<ul>
<li><a href="#orgd0a815c">3.1. squared rbf</a></li>
<li><a href="#org5c9ead5">3.2. Gauss</a></li>
<li><a href="#org28d8afd">3.3. Cardinal B<sub>3</sub> Spline</a></li>
<li><a href="#org3a8781b">3.4. Thin Plate</a></li>
</ul>
</li>
<li><a href="#org84c8526">4. PDE</a>
<ul>
<li><a href="#org8327160">4.1. PDE Poisson</a>
<ul>
<li><a href="#org12d215d">4.1.1. Plotting Utility</a></li>
<li><a href="#org4ea9556">4.1.2. Results</a></li>
</ul>
</li>
<li><a href="#org1c207d9">4.2. Diffusion PDE</a>
<ul>
<li><a href="#org002fa9c">4.2.1. Plotting utility</a></li>
<li><a href="#org98f5047">4.2.2. Results</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7c8c323">5. Domains</a></li>
</ul>
</div>
</div>
<div style="display:none">
\(
\newcommand{\RR}{\mathbb{R}}
\usepackage{amsmath}
\usepackage{amssymb}
\newtheorem{remark}{Remark}
\)
</div>
<div id="outline-container-org9cb0a95" class="outline-2">
<h2 id="org9cb0a95"><span class="section-number-2">1.</span> Projection Approach</h2>
<div class="outline-text-2" id="text-1">
<p>
Aim of this excrcise is to find solutions \(u\in \mathcal{H}_k\) such that they satisfy the following system
</p>

\begin{align}
\label{eq:pde}
- \nabla \cdot   \left( a(x) \nabla u(x) \right) &= f(x) & \text{in} \quad \Omega \\
u(x) &= g_D(x) & \text{on} \quad  \Gamma_D \\
\left( a(x) \nabla u(x)  \right) \cdot  \vec{n}(x) &= g_N & \text{on} \quad \Gamma_N
\end{align}
<p>
we do this by projecting the system onto \(\mathcal{H}_k(\Omega)\)
</p>
\begin{align}
\label{eq:pde_H}
\left<   - \nabla \cdot   \left( a(x) \nabla u(x) \right),\phi \right>&= \left< f(x) ,\phi  \right> & \text{in} \quad \Omega , \phi \in  \mathcal{H}_{k} \\
\left<   u(x) , \phi \right>&= \left< g_D(x) , \phi  \right> & \text{on} \quad  \Gamma_D \\
\left<   \left( a(x) \nabla u(x)  \right) \cdot  \vec{n}(x) , \phi \right>&= \left< g_N ,\phi  \right> & \text{on} \quad \Gamma_N
\end{align}
<p>
Let \( \hat{X}:=\left\{ x_j \right\}_{j=1}^n \subset\RR ^d\). Since \(\left\{ k(x_i,\cdot ) \right\}_{i=1}^n\) is the basis of a finite subspace in \(\mathcal{H}_k\) it also has to hold
</p>
\begin{align}
\label{eq:pde_proj}
\left<   - \nabla \cdot   \left( a(x) \nabla u(x) \right),k(x_i,\cdot ) \right>&= \left< f(x) ,k(x_i,\cdot )  \right> & \text{in} \quad \Omega , x_i \in  X \\
\left<   u(x) , k(x_i,\cdot ) \right>&= \left< g_D(x) , k(x_i,\cdot )  \right> & \text{on} \quad  \Gamma_D \\
\left<   \left( a(x) \nabla u(x)  \right) \cdot  \vec{n}(x) , k(x_i,\cdot ) \right>&= \left< g_N , k(x_i , \cdot )  \right> & \text{on} \quad \Gamma_N
\end{align}
<p>
We assuming \(f,g_D , g_N(\cdot ,\vec{n}) \in  \mathcal{H}_k\) i.e. \(\left< f , k(x_i , \cdot ) \right> = f(x_i)\) etc. We search for a finite approximation \(u_h \approx u\)
 such that it satisfies \eqref{eq:pde_proj} where
</p>
\begin{align}
\label{eq:approx}
u_h(x) &= \sum_{j=1}^{n} a_j k(x_j,x)
\end{align}
<p>
correspondingly we are able to directly compute
</p>

\begin{align*}
\nabla_x u_h(x) &= \sum_{j=1}^n a_j \nabla_x  k(x_j ,x) \\
- \nabla_x \cdot \left( a(x) \nabla_x u_h(x) \right) &= -  \nabla_x a(x) \cdot  \nabla_x u(x)  - a(x) \Delta_x u(x) \\
&=  - \sum_{j=1}^{n} a_j \left(  \nabla_x a(x) \cdot  \nabla_x k(x_j,x)   + a(x) \Delta_x k(x_j,x)\right)
\end{align*}
<p>
this leads to the following Linear system
</p>
\begin{align}
\label{eq:pde-sys}
 - \sum_{j=1}^{n} a_j \left(  \nabla_{x_i} a(x_i) \cdot  \nabla_{x_i} k(x_j,x_i)   + a(x_i) \Delta_{x_i} k(x_j,x_i)\right)&=  f(x_i)  & x_i\in  \Omega , x_i \in  X \\
 \sum_{j=1}^{n} a_j k(x_j,x_i)&=  g_D(x_i) & x_i\in   \Gamma_D \\
\sum_{j=1}^n  a_j \left( a(x_i) \nabla_{x_i}  k(x_j ,x_i) \cdot  n_i \right) &=  g_N(x_i , n_i) & x_i \in  \Gamma_N
\end{align}

<p>
this corresponds directly with the System Matrix \(K\), that we compute in julia using a GPU compatmible kernel that employs element wise notation
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_a90315fd16bb4acaa1dfe426845b5b17>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_a90315fd16bb4acaa1dfe426845b5b17=document.querySelector('button[name=btn_a90315fd16bb4acaa1dfe426845b5b17]');
copyBtnbtn_a90315fd16bb4acaa1dfe426845b5b17.addEventListener('click', function(event) {
let res = copyTextToClipboard(`\n@kernel function system_matrix!(K ,@Const(X), a , ∇a ,k, ∇k, Δk  , sdf , grad_sdf , sdf_beta)\n    Iᵢⱼ =  @index(Global , Cartesian)\n    @inbounds xᵢ= SVector{2}(view(X, : , Iᵢⱼ[1])) # Essentially X[:,i]\n    @inbounds xⱼ= SVector{2}(view(X, : , Iᵢⱼ[2])) # Essentially X[:,j]\n    # poisson equation\n    @inbounds K[Iᵢⱼ] = -a(xᵢ)*Δk(xⱼ ,xᵢ)- ∇a(xᵢ)⋅∇k(xⱼ ,xᵢ)\n    if abs(sdf(xᵢ)) < 1e-10\n        if sdf_beta(xᵢ) < 0\n            # Neumann Boundary Condition\n            @inbounds nᵢ= grad_sdf(xᵢ)\n            @inbounds K[Iᵢⱼ] = a(xᵢ) * (nᵢ ⋅ ∇k( xⱼ , xᵢ ))\n        else\n          # Dirichlet Boundary\n          @inbounds K[Iᵢⱼ] =k(xᵢ , xⱼ)\n        end\n    end\nend\n`);copyBtnbtn_a90315fd16bb4acaa1dfe426845b5b17.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_a90315fd16bb4acaa1dfe426845b5b17.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia">
<span style="color: #c5c8c6; font-weight: bold;">@kernel</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> system_matrix!(K ,<span style="color: #c5c8c6; font-weight: bold;">@Const</span>(X), a , &#8711;a ,k, &#8711;k, &#916;k  , sdf , grad_sdf , sdf_beta)
    I&#7522;&#11388; =  <span style="color: #c5c8c6; font-weight: bold;">@index</span>(Global , Cartesian)
    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> x&#7522;= SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(view(X, : , I&#7522;&#11388;[<span style="color: #de935f; font-weight: bold;">1</span>])) <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Essentially X[:,i]</span>
    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> x&#11388;= SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(view(X, : , I&#7522;&#11388;[<span style="color: #de935f; font-weight: bold;">2</span>])) <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Essentially X[:,j]</span>
    <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">poisson equation</span>
    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> K[I&#7522;&#11388;] = <span style="color: #f0c674;">-</span>a(x&#7522;)<span style="color: #f0c674;">*</span>&#916;k(x&#11388; ,x&#7522;)<span style="color: #f0c674;">-</span> &#8711;a(x&#7522;)&#8901;&#8711;k(x&#11388; ,x&#7522;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">if</span> abs(sdf(x&#7522;)) <span style="color: #f0c674;">&lt;</span> <span style="color: #de935f; font-weight: bold;">1e-10</span>
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">if</span> sdf_beta(x&#7522;) <span style="color: #f0c674;">&lt;</span> <span style="color: #de935f; font-weight: bold;">0</span>
            <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Neumann Boundary Condition</span>
            <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> n&#7522;= grad_sdf(x&#7522;)
            <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> K[I&#7522;&#11388;] = a(x&#7522;) <span style="color: #f0c674;">*</span> (n&#7522; &#8901; &#8711;k( x&#11388; , x&#7522; ))
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">else</span>
          <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Dirichlet Boundary</span>
          <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> K[I&#7522;&#11388;] =k(x&#7522; , x&#11388;)
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<pre class="example">
julia-async:50c35846-ece5-4961-8a3a-800152c4bb4f
</pre>
</div>
<div id="outline-container-org6bd8cd1" class="outline-3">
<h3 id="org6bd8cd1"><span class="section-number-3">1.1.</span> right hand side</h3>
<div class="outline-text-3" id="text-1-1">
<p>
The right hand side of the system is computed in a similar Fashion
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_a3b706334d6d411887ec40f9cce46269>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_a3b706334d6d411887ec40f9cce46269=document.querySelector('button[name=btn_a3b706334d6d411887ec40f9cce46269]');
copyBtnbtn_a3b706334d6d411887ec40f9cce46269.addEventListener('click', function(event) {
let res = copyTextToClipboard(`\n@kernel function apply_function_colwise!(B ,@Const(X) , f , g_D , g_N , sdf  , grad_sdf, sdf_beta)\n    # boilerplate\n    Iᵢ = @index(Global , Cartesian)\n    @inbounds xᵢ= SVector{2}(view(X , : , Iᵢ[1]))\n    # poisson equation\n\n    @inbounds B[Iᵢ] = f(xᵢ)\n    if abs(sdf(xᵢ)) < 1e-10\n         if sdf_beta(xᵢ) < 0\n             # Neumann Boundary Condition\n             @inbounds nᵢ= grad_sdf(xᵢ)\n             @inbounds B[Iᵢ] = g_N(xᵢ , nᵢ )\n         else\n            # Dirichlet Boundary\n            @inbounds B[Iᵢ] = g_D(xᵢ)\n         end\n     end\nend\n`);copyBtnbtn_a3b706334d6d411887ec40f9cce46269.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_a3b706334d6d411887ec40f9cce46269.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia">
<span style="color: #c5c8c6; font-weight: bold;">@kernel</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> apply_function_colwise!(B ,<span style="color: #c5c8c6; font-weight: bold;">@Const</span>(X) , f , g_D , g_N , sdf  , grad_sdf, sdf_beta)
    <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">boilerplate</span>
    I&#7522; = <span style="color: #c5c8c6; font-weight: bold;">@index</span>(Global , Cartesian)
    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> x&#7522;= SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(view(X , : , I&#7522;[<span style="color: #de935f; font-weight: bold;">1</span>]))
    <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">poisson equation</span>

    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> B[I&#7522;] = f(x&#7522;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">if</span> abs(sdf(x&#7522;)) <span style="color: #f0c674;">&lt;</span> <span style="color: #de935f; font-weight: bold;">1e-10</span>
         <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">if</span> sdf_beta(x&#7522;) <span style="color: #f0c674;">&lt;</span> <span style="color: #de935f; font-weight: bold;">0</span>
             <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Neumann Boundary Condition</span>
             <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> n&#7522;= grad_sdf(x&#7522;)
             <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> B[I&#7522;] = g_N(x&#7522; , n&#7522; )
         <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">else</span>
            <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Dirichlet Boundary</span>
            <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> B[I&#7522;] = g_D(x&#7522;)
         <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
     <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>
</div>
</div>
<div id="outline-container-orgc385bc2" class="outline-3">
<h3 id="orgc385bc2"><span class="section-number-3">1.2.</span> Kernel Matrix for evaluation</h3>
<div class="outline-text-3" id="text-1-2">
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_c38933bb44294d2e86a3f09fcb28af10>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_c38933bb44294d2e86a3f09fcb28af10=document.querySelector('button[name=btn_c38933bb44294d2e86a3f09fcb28af10]');
copyBtnbtn_c38933bb44294d2e86a3f09fcb28af10.addEventListener('click', function(event) {
let res = copyTextToClipboard(`\n@kernel function kernel_matrix!(A , @Const(X_test) , @Const(X_col) ,k , sdf)\n    Iᵢⱼ =  @index(Global , Cartesian)\n    @inbounds xᵢ= SVector{2}(view(X_test , : , Iᵢⱼ[1])) # Essentially X[:,1]\n    @inbounds xⱼ= SVector{2}(view(X_col , : , Iᵢⱼ[2]))\n    K = k(xᵢ , xⱼ)\n    # Mask outside Domain with NaN\n    if sdf(xᵢ) > 0\n        K = NaN\n        end\n    @inbounds A[Iᵢⱼ] = K\nend\n`);copyBtnbtn_c38933bb44294d2e86a3f09fcb28af10.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_c38933bb44294d2e86a3f09fcb28af10.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia">
<span style="color: #c5c8c6; font-weight: bold;">@kernel</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> kernel_matrix!(A , <span style="color: #c5c8c6; font-weight: bold;">@Const</span>(X_test) , <span style="color: #c5c8c6; font-weight: bold;">@Const</span>(X_col) ,k , sdf)
    I&#7522;&#11388; =  <span style="color: #c5c8c6; font-weight: bold;">@index</span>(Global , Cartesian)
    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> x&#7522;= SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(view(X_test , : , I&#7522;&#11388;[<span style="color: #de935f; font-weight: bold;">1</span>])) <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Essentially X[:,1]</span>
    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> x&#11388;= SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(view(X_col , : , I&#7522;&#11388;[<span style="color: #de935f; font-weight: bold;">2</span>]))
    K = k(x&#7522; , x&#11388;)
    <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Mask outside Domain with NaN</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">if</span> sdf(x&#7522;) <span style="color: #f0c674;">&gt;</span> <span style="color: #de935f; font-weight: bold;">0</span>
        K = <span style="color: var(--clr-constant); background-color: var(--bg-constant);">NaN</span>
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
    <span style="color: #c5c8c6; font-weight: bold;">@inbounds</span> A[I&#7522;&#11388;] = K
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>
</div>
</div>
</div>
<div id="outline-container-orge8bc26d" class="outline-2">
<h2 id="orge8bc26d"><span class="section-number-2">2.</span> Solver</h2>
<div class="outline-text-2" id="text-2">
<p>
Our implementation Provides some structs for convenience. A <code>PDESystem</code> that stores the Data functions of a diffusion PDE together with the kernel and its derrivatives \(k , \nabla k , \Delta k\) and information about the Domain of the problem in form if its signed distance function and Its gradient (for normals at the boundary)
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_db640969b67d4b17912685d3934f9ed1>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_db640969b67d4b17912685d3934f9ed1=document.querySelector('button[name=btn_db640969b67d4b17912685d3934f9ed1]');
copyBtnbtn_db640969b67d4b17912685d3934f9ed1.addEventListener('click', function(event) {
let res = copyTextToClipboard(`struct PDESystem\n    k :: Function\n    ∇k :: Function\n    Δk :: Function\n    a :: Function\n    ∇a::Function\n    f::Function\n    g_D::Function\n    g_N::Function\n    sdf::Function\n    grad_sdf::Function\n    sdf_beta::Function\nend\n\n`);copyBtnbtn_db640969b67d4b17912685d3934f9ed1.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_db640969b67d4b17912685d3934f9ed1.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">struct</span> <span style="color: #f0c674;">PDESystem</span>
    k <span style="color: #f0c674;">::</span> <span style="color: #f0c674;">Function</span>
    &#8711;k <span style="color: #f0c674;">::</span> <span style="color: #f0c674;">Function</span>
    &#916;k <span style="color: #f0c674;">::</span> <span style="color: #f0c674;">Function</span>
    a <span style="color: #f0c674;">::</span> <span style="color: #f0c674;">Function</span>
    &#8711;a<span style="color: #f0c674;">::Function</span>
    f<span style="color: #f0c674;">::Function</span>
    g_D<span style="color: #f0c674;">::Function</span>
    g_N<span style="color: #f0c674;">::Function</span>
    sdf<span style="color: #f0c674;">::Function</span>
    grad_sdf<span style="color: #f0c674;">::Function</span>
    sdf_beta<span style="color: #f0c674;">::Function</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

</pre>
</div></div>
<p>
We provide a  <code>PDESolver</code> that stores The PDE system, Collocation points \(\hat{X}\) , and the solution vector \(\alpha \) in \(u_h = \sum_{j=0}^n \alpha_j k(x_j , \cdot )\)
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_d8f09c2d9fc043a09bce45adc4f95575>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_d8f09c2d9fc043a09bce45adc4f95575=document.querySelector('button[name=btn_d8f09c2d9fc043a09bce45adc4f95575]');
copyBtnbtn_d8f09c2d9fc043a09bce45adc4f95575.addEventListener('click', function(event) {
let res = copyTextToClipboard(`struct PDESolver\n    S::PDESystem\n    X::AbstractMatrix\n    α :: AbstractVector\nend\n\n`);copyBtnbtn_d8f09c2d9fc043a09bce45adc4f95575.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_d8f09c2d9fc043a09bce45adc4f95575.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">struct</span> <span style="color: #f0c674;">PDESolver</span>
    S<span style="color: #f0c674;">::PDESystem</span>
    X<span style="color: #f0c674;">::AbstractMatrix</span>
    &#945; <span style="color: #f0c674;">::</span> <span style="color: #f0c674;">AbstractVector</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

</pre>
</div></div>
<p>
<code>PDESolver</code> Provides methods for evaluation itselve on a test dataset
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_674a71ebc74847b58a65d495ba75997f>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_674a71ebc74847b58a65d495ba75997f=document.querySelector('button[name=btn_674a71ebc74847b58a65d495ba75997f]');
copyBtnbtn_674a71ebc74847b58a65d495ba75997f.addEventListener('click', function(event) {
let res = copyTextToClipboard(`function (f::PDESolver)(X)\n    dev = get_backend(X)\n    print(\"Backend\" , dev)\n    K = KernelAbstractions.zeros(dev , Float32, size(X,2)  , size(f.X ,2))\n    print(\"Size of the system Matrix:\" , size(K))\n    km! = kernel_matrix!( dev , 256 , size(K))\n    km!(K, X , f.X , f.S.k , f.S.sdf )\nreturn K * f.α , K\nend\n\n`);copyBtnbtn_674a71ebc74847b58a65d495ba75997f.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_674a71ebc74847b58a65d495ba75997f.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> (f<span style="color: #f0c674;">::PDESolver</span>)(X)
    dev = get_backend(X)
    print(<span style="color: var(--clr-string); background-color: var(--bg-string);">"Backend"</span> , dev)
    K = KernelAbstractions.zeros(dev , Float32, size(X,<span style="color: #de935f; font-weight: bold;">2</span>)  , size(f.X ,<span style="color: #de935f; font-weight: bold;">2</span>))
    print(<span style="color: var(--clr-string); background-color: var(--bg-string);">"Size of the system Matrix:"</span> , size(K))
    km! = kernel_matrix!( dev , <span style="color: #de935f; font-weight: bold;">256</span> , size(K))
    km!(K, X , f.X , f.S.k , f.S.sdf )
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> K <span style="color: #f0c674;">*</span> f.&#945; , K
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

</pre>
</div></div>

<p>
As well as a method to solve the approximation system and return a instance of <code>PDESystem</code>
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_f76b9358d765437684a6941d6d7f8270>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_f76b9358d765437684a6941d6d7f8270=document.querySelector('button[name=btn_f76b9358d765437684a6941d6d7f8270]');
copyBtnbtn_f76b9358d765437684a6941d6d7f8270.addEventListener('click', function(event) {
let res = copyTextToClipboard(`function solve(S, X_col)\n    dev = get_backend(X_col)\n    K = KernelAbstractions.zeros(dev , Float32 , size(X_col , 2) , size(X_col , 2) )\n    sys_matrix! = system_matrix!( dev , 256 , size(K))\n    sys_matrix!(K ,X_col , S.a , S.∇a , S.k , S.∇k , S.Δk , S.sdf , S.grad_sdf , S.sdf_beta  )\n    B = get_boundary(S,X_col)\n    α = K \\ B\n    return (PDESolver(S,X_col ,α) , K)\n    end\n\n\n`);copyBtnbtn_f76b9358d765437684a6941d6d7f8270.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_f76b9358d765437684a6941d6d7f8270.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">solve</span>(S, X_col)
    dev = get_backend(X_col)
    K = KernelAbstractions.zeros(dev , Float32 , size(X_col , <span style="color: #de935f; font-weight: bold;">2</span>) , size(X_col , <span style="color: #de935f; font-weight: bold;">2</span>) )
    sys_matrix! = system_matrix!( dev , <span style="color: #de935f; font-weight: bold;">256</span> , size(K))
    sys_matrix!(K ,X_col , S.a , S.&#8711;a , S.k , S.&#8711;k , S.&#916;k , S.sdf , S.grad_sdf , S.sdf_beta  )
    B = get_boundary(S,X_col)
    &#945; = K <span style="color: #f0c674;">\</span> B
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> (PDESolver(S,X_col ,&#945;) , K)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>


</pre>
</div></div>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_3ce40ebcbd9141429234b59de959246f>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_3ce40ebcbd9141429234b59de959246f=document.querySelector('button[name=btn_3ce40ebcbd9141429234b59de959246f]');
copyBtnbtn_3ce40ebcbd9141429234b59de959246f.addEventListener('click', function(event) {
let res = copyTextToClipboard(`function get_boundary(\n    S,\n    X\n    )\n    dev = get_backend(X)\n    B = KernelAbstractions.zeros(dev , Float32 , size(X , 2))\n    apply! = apply_function_colwise!(dev , 256 , size(B))\n    apply!(B , X , S.f , S.g_D , S.g_N , S.sdf  , S.grad_sdf, S.sdf_beta)\n    return B\n    end\n\n`);copyBtnbtn_3ce40ebcbd9141429234b59de959246f.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_3ce40ebcbd9141429234b59de959246f.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">get_boundary</span>(
    S,
    X
    )
    dev = get_backend(X)
    B = KernelAbstractions.zeros(dev , Float32 , size(X , <span style="color: #de935f; font-weight: bold;">2</span>))
    apply! = apply_function_colwise!(dev , <span style="color: #de935f; font-weight: bold;">256</span> , size(B))
    apply!(B , X , S.f , S.g_D , S.g_N , S.sdf  , S.grad_sdf, S.sdf_beta)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> B
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

</pre>
</div></div>

<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_03b81dd9f14c4c32927111c8bef045cd>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_03b81dd9f14c4c32927111c8bef045cd=document.querySelector('button[name=btn_03b81dd9f14c4c32927111c8bef045cd]');
copyBtnbtn_03b81dd9f14c4c32927111c8bef045cd.addEventListener('click', function(event) {
let res = copyTextToClipboard(`end\n`);copyBtnbtn_03b81dd9f14c4c32927111c8bef045cd.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_03b81dd9f14c4c32927111c8bef045cd.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<p>
we tested our solver for compatibility with a CPU and A GPU Backend on a modern 16Core CPU and a RTX 4070. The GPU backend was ~8x faster for a system with 10000 DOF. (~120ms vs ~1.s)
</p>
</div>
</div>
<div id="outline-container-org5bdcfd8" class="outline-2">
<h2 id="org5bdcfd8"><span class="section-number-2">3.</span> Kernel Implementation</h2>
<div class="outline-text-2" id="text-3">
<p>
As kernels we use Radial Basis Kernels (RBF) \(k(x,x') := \phi (\frac{\|x-x'\|}{\gamma})\). That consist of a radial basis function \(\phi \) as well as a scaling factor \(\gamma \)
where \(\nabla_x , \Delta_x\) are the partial gradients and laplacians with respect to the second argument of \(k(x_j, \cdot )\).
for a radial basis function \(\phi (r^2) \in  C^2(\RR)\)  and a corresponding RBF kernel  they can be computed directly
</p>
\begin{align}
\label{eq:2}
\nabla_x k(x',x) &= \phi'\left(\frac{\|x - x'\|}{\gamma}\right) \cdot \frac{x - x'}{\gamma\|x - x'\|} \\
\Delta_x k(x',x) &= \frac{1}{\gamma^2} \phi''\left(\frac{\|x - x'\|}{\gamma}\right) + \frac{1}{\gamma} \frac{d - 1}{\|x - x'\|} \cdot \phi'\left(\frac{\|x - x'\|}{\gamma}\right)
\end{align}
<p>
where \(d\) is the dimension of \(x\). Note that those expressions are singular for \(r=0\). we prevent this numerically by using \(\max(10^{-15} , r)\) instead of \(r\).
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_e71d00b406194e6abcec3ff943888317>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_e71d00b406194e6abcec3ff943888317=document.querySelector('button[name=btn_e71d00b406194e6abcec3ff943888317]');
copyBtnbtn_e71d00b406194e6abcec3ff943888317.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using StaticArrays\n@inline function k(ϕ::RBFType , ::Val{γ},x̂::SVector{N} ,x::SVector{N}) where {N , γ , RBFType}\n    r = max(1e-15,norm(x-x̂))\n    ϕ(r/γ)\n    end\n@inline function ∇k(dϕ::dRBFType , ::Val{γ} ,x̂::SVector{N} ,x::SVector{N}) where {N , γ , dRBFType}\n    r = max(1e-15,norm(x-x̂))\n    (x-x̂)*dϕ(r/γ) *  1/(r*γ)\n    end\n@inline function Δk(d²ϕ::ddRBFType,  dϕ::dRBFType , ::Val{γ} ,x̂::SVector{N} ,x::SVector{N}) where {N , γ , ddRBFType , dRBFType}\n    r = max(1e-15,norm(x-x̂))\n    1/γ^2 * d²ϕ(r/γ)  +  1/γ * (N-1)/r *dϕ(r/γ)\n    end\n`);copyBtnbtn_e71d00b406194e6abcec3ff943888317.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_e71d00b406194e6abcec3ff943888317.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> StaticArrays
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">k</span>(&#981;<span style="color: #f0c674;">::RBFType</span> , <span style="color: #f0c674;">::Val</span>{&#947;},x&#770;<span style="color: #f0c674;">::SVector</span>{N} ,x<span style="color: #f0c674;">::SVector</span>{N}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> {N , &#947; , RBFType}
    r = max(<span style="color: #de935f; font-weight: bold;">1e-15</span>,norm(x<span style="color: #f0c674;">-</span>x&#770;))
    &#981;(r<span style="color: #f0c674;">/</span>&#947;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;k</span>(d&#981;<span style="color: #f0c674;">::dRBFType</span> , <span style="color: #f0c674;">::Val</span>{&#947;} ,x&#770;<span style="color: #f0c674;">::SVector</span>{N} ,x<span style="color: #f0c674;">::SVector</span>{N}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> {N , &#947; , dRBFType}
    r = max(<span style="color: #de935f; font-weight: bold;">1e-15</span>,norm(x<span style="color: #f0c674;">-</span>x&#770;))
    (x<span style="color: #f0c674;">-</span>x&#770;)<span style="color: #f0c674;">*</span>d&#981;(r<span style="color: #f0c674;">/</span>&#947;) <span style="color: #f0c674;">*</span>  <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span>(r<span style="color: #f0c674;">*</span>&#947;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#916;k</span>(d&#178;&#981;<span style="color: #f0c674;">::ddRBFType</span>,  d&#981;<span style="color: #f0c674;">::dRBFType</span> , <span style="color: #f0c674;">::Val</span>{&#947;} ,x&#770;<span style="color: #f0c674;">::SVector</span>{N} ,x<span style="color: #f0c674;">::SVector</span>{N}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> {N , &#947; , ddRBFType , dRBFType}
    r = max(<span style="color: #de935f; font-weight: bold;">1e-15</span>,norm(x<span style="color: #f0c674;">-</span>x&#770;))
    <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span>&#947;<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span> <span style="color: #f0c674;">*</span> d&#178;&#981;(r<span style="color: #f0c674;">/</span>&#947;)  <span style="color: #f0c674;">+</span>  <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span>&#947; <span style="color: #f0c674;">*</span> (N<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1</span>)<span style="color: #f0c674;">/</span>r <span style="color: #f0c674;">*</span>d&#981;(r<span style="color: #f0c674;">/</span>&#947;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>
</div>
<div id="outline-container-orgd0a815c" class="outline-3">
<h3 id="orgd0a815c"><span class="section-number-3">3.1.</span> squared rbf</h3>
<div class="outline-text-3" id="text-3-1">
<p>
for a squared RBF the kernels \(k(x,x') := \phi (\frac{\|x-x'\|^2}{\gamma})\) are simpler. and non singular
</p>
\begin{align}
\label{eq:sqr-rbf}
\nabla_x k(x',x) &= \phi'\left(\frac{r^2}{\gamma}\right) \cdot \frac{x - x'}{\gamma} \\
\Delta_x k(x',x) &= \frac{1}{\gamma } (4 * \frac{r^2}{\gamma^2} \phi''\left(\frac{r^2}{\gamma}\right) + 2d\phi'\left(\frac{r^2}{\gamma}\right))
\end{align}
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_3324db0bc95d45979dd230a1bf31eb1b>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_3324db0bc95d45979dd230a1bf31eb1b=document.querySelector('button[name=btn_3324db0bc95d45979dd230a1bf31eb1b]');
copyBtnbtn_3324db0bc95d45979dd230a1bf31eb1b.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using StaticArrays\nusing LinearAlgebra\n@inline function ksq(ϕ::RBFType , ::Val{γ},x̂::SVector{N} ,x::SVector{N}) where {N , γ , RBFType}\n    r = dot(x-x̂,x-x̂)\n    ϕ(r/γ)\n    end\n@inline function ∇ksq(dϕ::dRBFType , ::Val{γ} ,x̂::SVector{N} ,x::SVector{N}) where {N , γ , dRBFType}\n    r = dot(x-x̂,x-x̂)\n    2/γ^2*(x-x̂)*dϕ(r/γ)\n    end\n@inline function Δksq(d²ϕ::ddRBFType,  dϕ::Function , ::Val{γ} ,x̂::SVector{N} ,x::SVector{N}) where {N , γ , ddRBFType , dRBFType}\n    r = dot(x-x̂,x-x̂)\n    1/γ^2 * 4*r * d²ϕ(r/γ)  + 2/γ*N*dϕ(r/γ)\n    end\n`);copyBtnbtn_3324db0bc95d45979dd230a1bf31eb1b.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_3324db0bc95d45979dd230a1bf31eb1b.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> StaticArrays
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> LinearAlgebra
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">ksq</span>(&#981;<span style="color: #f0c674;">::RBFType</span> , <span style="color: #f0c674;">::Val</span>{&#947;},x&#770;<span style="color: #f0c674;">::SVector</span>{N} ,x<span style="color: #f0c674;">::SVector</span>{N}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> {N , &#947; , RBFType}
    r = dot(x<span style="color: #f0c674;">-</span>x&#770;,x<span style="color: #f0c674;">-</span>x&#770;)
    &#981;(r<span style="color: #f0c674;">/</span>&#947;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;ksq</span>(d&#981;<span style="color: #f0c674;">::dRBFType</span> , <span style="color: #f0c674;">::Val</span>{&#947;} ,x&#770;<span style="color: #f0c674;">::SVector</span>{N} ,x<span style="color: #f0c674;">::SVector</span>{N}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> {N , &#947; , dRBFType}
    r = dot(x<span style="color: #f0c674;">-</span>x&#770;,x<span style="color: #f0c674;">-</span>x&#770;)
    <span style="color: #de935f; font-weight: bold;">2</span><span style="color: #f0c674;">/</span>&#947;<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span><span style="color: #f0c674;">*</span>(x<span style="color: #f0c674;">-</span>x&#770;)<span style="color: #f0c674;">*</span>d&#981;(r<span style="color: #f0c674;">/</span>&#947;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#916;ksq</span>(d&#178;&#981;<span style="color: #f0c674;">::ddRBFType</span>,  d&#981;<span style="color: #f0c674;">::Function</span> , <span style="color: #f0c674;">::Val</span>{&#947;} ,x&#770;<span style="color: #f0c674;">::SVector</span>{N} ,x<span style="color: #f0c674;">::SVector</span>{N}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> {N , &#947; , ddRBFType , dRBFType}
    r = dot(x<span style="color: #f0c674;">-</span>x&#770;,x<span style="color: #f0c674;">-</span>x&#770;)
    <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span>&#947;<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span> <span style="color: #f0c674;">*</span> <span style="color: #de935f; font-weight: bold;">4</span><span style="color: #f0c674;">*</span>r <span style="color: #f0c674;">*</span> d&#178;&#981;(r<span style="color: #f0c674;">/</span>&#947;)  <span style="color: #f0c674;">+</span> <span style="color: #de935f; font-weight: bold;">2</span><span style="color: #f0c674;">/</span>&#947;<span style="color: #f0c674;">*</span>N<span style="color: #f0c674;">*</span>d&#981;(r<span style="color: #f0c674;">/</span>&#947;)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<pre class="example">
julia-async:70c08408-31c3-4adc-bc82-d8865b93b190
</pre>
</div>
</div>
<div id="outline-container-org5c9ead5" class="outline-3">
<h3 id="org5c9ead5"><span class="section-number-3">3.2.</span> Gauss</h3>
<div class="outline-text-3" id="text-3-2">
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_f1db6b4707c9409398c0fea414d97082>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_f1db6b4707c9409398c0fea414d97082=document.querySelector('button[name=btn_f1db6b4707c9409398c0fea414d97082]');
copyBtnbtn_f1db6b4707c9409398c0fea414d97082.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using StaticArrays\n@inline function rbf_gaussian(r)\n    exp(-r)\n    end\n@inline function d_rbf_gaussian(r)\n    -exp(-r)\n    end\n@inline function dd_rbf_gaussian(r)\n    exp(-r)\n    end\n`);copyBtnbtn_f1db6b4707c9409398c0fea414d97082.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_f1db6b4707c9409398c0fea414d97082.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> StaticArrays
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">rbf_gaussian</span>(r)
    exp(<span style="color: #f0c674;">-</span>r)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">d_rbf_gaussian</span>(r)
    <span style="color: #f0c674;">-</span>exp(<span style="color: #f0c674;">-</span>r)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">dd_rbf_gaussian</span>(r)
    exp(<span style="color: #f0c674;">-</span>r)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<pre class="example">
julia-async:f3f21d6e-71df-4891-8781-f0dd47c6dd10
</pre>


<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_89da9ee9a21047f5b4c16458b81deed3>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_89da9ee9a21047f5b4c16458b81deed3=document.querySelector('button[name=btn_89da9ee9a21047f5b4c16458b81deed3]');
copyBtnbtn_89da9ee9a21047f5b4c16458b81deed3.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nX = range(-2 , 2 , 100)\nusing LinearAlgebra\n\nfig = Figure()\nax = Axis(fig[1,1])\nlines!(ax , X ,x->    rbf_gaussian(x^2), label=L\"gauss\")\nlines!(ax , X ,x-> -2x* d_rbf_gaussian(x^2) , label=L\"\\partial gauss\")\nlines!(ax , X ,x-> 4x^2* dd_rbf_gaussian(x^2) , label=L\"\\partial^2 gauss\")\naxislegend(ax)\nsave(\"images/gauss-rbf.png\",fig )\n`);copyBtnbtn_89da9ee9a21047f5b4c16458b81deed3.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_89da9ee9a21047f5b4c16458b81deed3.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
X = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">2</span> , <span style="color: #de935f; font-weight: bold;">2</span> , <span style="color: #de935f; font-weight: bold;">100</span>)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> LinearAlgebra

fig = Figure()
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: #de935f; font-weight: bold;">1</span>])
lines!(ax , X ,x<span style="color: #f0c674;">-&gt;</span>    rbf_gaussian(x<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>), label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"gauss"</span>)
lines!(ax , X ,x<span style="color: #f0c674;">-&gt;</span> <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">2</span>x<span style="color: #f0c674;">*</span> d_rbf_gaussian(x<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>) , label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\partial gauss"</span>)
lines!(ax , X ,x<span style="color: #f0c674;">-&gt;</span> <span style="color: #de935f; font-weight: bold;">4</span>x<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span><span style="color: #f0c674;">*</span> dd_rbf_gaussian(x<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>) , label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\partial^2 gauss"</span>)
axislegend(ax)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/gauss-rbf.png"</span>,fig )
</pre>
</div></div>


<div id="org8aa6045" class="figure">
<p><img src="images/gauss-rbf.png" alt="gauss-rbf.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org28d8afd" class="outline-3">
<h3 id="org28d8afd"><span class="section-number-3">3.3.</span> Cardinal B<sub>3</sub> Spline</h3>
<div class="outline-text-3" id="text-3-3">
\begin{align*}
B_{d}(r) = \sum_{n=0}^4 \frac{(-1)^n}{d!} \binom{d+1}{n} \left( r + \frac{d+1}{2}-n \right)^d_+
\end{align*}
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_b448cffaebd9416293ccd9f6bd785dcb>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_b448cffaebd9416293ccd9f6bd785dcb=document.querySelector('button[name=btn_b448cffaebd9416293ccd9f6bd785dcb]');
copyBtnbtn_b448cffaebd9416293ccd9f6bd785dcb.addEventListener('click', function(event) {
let res = copyTextToClipboard(`function B_3(r)\nr_prime = r+2\n    return 1/24 * (\n    1 *max(0, (r_prime - 0))^3\n    -4*max(0, (r_prime - 1))^3\n    +6*max(0, (r_prime - 2))^3\n    -4*max(0, (r_prime - 3))^3\n    +1*max(0, (r_prime - 4))^3\n    )\nend\nfunction d_B_3(r)\nr_prime = r+2\n    return 1/8 * (\n    1 *max(0, (r_prime - 0))^2\n    -4*max(0, (r_prime - 1))^2\n    +6*max(0, (r_prime - 2))^2\n    -4*max(0, (r_prime - 3))^2\n    +1*max(0, (r_prime - 4))^2\n    )\nend\nfunction dd_B_3(r)\nr_prime = r+2\n    return 1/4 * (\n    1 *max(0, (r_prime - 0))\n    -4*max(0, (r_prime - 1))\n    +6*max(0, (r_prime - 2))\n    -4*max(0, (r_prime - 3))\n    +1*max(0, (r_prime - 4))\n    )\nend\n\n`);copyBtnbtn_b448cffaebd9416293ccd9f6bd785dcb.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_b448cffaebd9416293ccd9f6bd785dcb.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">B_3</span>(r)
r_prime = r<span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">2</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span><span style="color: #de935f; font-weight: bold;">24</span> <span style="color: #f0c674;">*</span> (
    <span style="color: #de935f; font-weight: bold;">1</span> <span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">0</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">3</span>
    <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">4</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">1</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">3</span>
    <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">6</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">2</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">3</span>
    <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">4</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">3</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">3</span>
    <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">4</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">3</span>
    )
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">d_B_3</span>(r)
r_prime = r<span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">2</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span><span style="color: #de935f; font-weight: bold;">8</span> <span style="color: #f0c674;">*</span> (
    <span style="color: #de935f; font-weight: bold;">1</span> <span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">0</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>
    <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">4</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">1</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>
    <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">6</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">2</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>
    <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">4</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">3</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>
    <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">4</span>))<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>
    )
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">dd_B_3</span>(r)
r_prime = r<span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">2</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span><span style="color: #de935f; font-weight: bold;">4</span> <span style="color: #f0c674;">*</span> (
    <span style="color: #de935f; font-weight: bold;">1</span> <span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">0</span>))
    <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">4</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">1</span>))
    <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">6</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">2</span>))
    <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">4</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">3</span>))
    <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">*</span>max(<span style="color: #de935f; font-weight: bold;">0</span>, (r_prime <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">4</span>))
    )
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

</pre>
</div></div>

<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_28a234e1c3ce4576921cc4e736c05c94>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_28a234e1c3ce4576921cc4e736c05c94=document.querySelector('button[name=btn_28a234e1c3ce4576921cc4e736c05c94]');
copyBtnbtn_28a234e1c3ce4576921cc4e736c05c94.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nusing LaTeXStrings\nX = range(-2 , 2 , 100)\nY = range(-2 , 2 , 100)\n\nfig = Figure()\nax = Axis(fig[1,1])\n\nlines!(ax , X , B_3 , label=L\"B_3\")\nlines!(ax , X , d_B_3 , label=L\"\\partial B_3\")\nlines!(ax , X , dd_B_3 , label=L\"\\partial^2 B_3\")\naxislegend(ax)\nsave(\"images/b-spline.png\",fig )\n`);copyBtnbtn_28a234e1c3ce4576921cc4e736c05c94.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_28a234e1c3ce4576921cc4e736c05c94.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="org7e93206"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> LaTeXStrings
X = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">2</span> , <span style="color: #de935f; font-weight: bold;">2</span> , <span style="color: #de935f; font-weight: bold;">100</span>)
Y = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">2</span> , <span style="color: #de935f; font-weight: bold;">2</span> , <span style="color: #de935f; font-weight: bold;">100</span>)

fig = Figure()
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: #de935f; font-weight: bold;">1</span>])

lines!(ax , X , B_3 , label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"B_3"</span>)
lines!(ax , X , d_B_3 , label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\partial B_3"</span>)
lines!(ax , X , dd_B_3 , label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\partial^2 B_3"</span>)
axislegend(ax)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/b-spline.png"</span>,fig )
</pre>
</div></div>


<div id="org3ea68cf" class="figure">
<p><img src="images/b-spline.png" alt="b-spline.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org3a8781b" class="outline-3">
<h3 id="org3a8781b"><span class="section-number-3">3.4.</span> Thin Plate</h3>
<div class="outline-text-3" id="text-3-4">
\begin{align*}
T(r^2) &= \frac{1}{2}r\ln{r} \\
T(r) &= r^2\ln{r}
\end{align*}
<p>
note that the thin plate kernel is not p.d. it is c.p.d. However this seemed a non issue numerically
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_71d606bbf1fa41138cff3ad3ef7d0cbb>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_71d606bbf1fa41138cff3ad3ef7d0cbb=document.querySelector('button[name=btn_71d606bbf1fa41138cff3ad3ef7d0cbb]');
copyBtnbtn_71d606bbf1fa41138cff3ad3ef7d0cbb.addEventListener('click', function(event) {
let res = copyTextToClipboard(`function thin_plate(r)\n    r == 0.0 && return 0.0\n    return 0.5* r *  log(r)\nend\n\nfunction d_thin_plate(r)\n    r == 0.0 && return 0.0\n    return 0.5 * log(r) + 1\nend\n\nfunction dd_thin_plate(r)\n    r == 0.0 && return 0.0\n    return 0.5 * 1/r\nend\n`);copyBtnbtn_71d606bbf1fa41138cff3ad3ef7d0cbb.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_71d606bbf1fa41138cff3ad3ef7d0cbb.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">thin_plate</span>(r)
    r <span style="color: #f0c674;">==</span> <span style="color: #de935f; font-weight: bold;">0.0</span> <span style="color: #f0c674;">&amp;&amp;</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">0.0</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">0.5</span><span style="color: #f0c674;">*</span> r <span style="color: #f0c674;">*</span>  log(r)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">d_thin_plate</span>(r)
    r <span style="color: #f0c674;">==</span> <span style="color: #de935f; font-weight: bold;">0.0</span> <span style="color: #f0c674;">&amp;&amp;</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">0.0</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">0.5</span> <span style="color: #f0c674;">*</span> log(r) <span style="color: #f0c674;">+</span> <span style="color: #de935f; font-weight: bold;">1</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">dd_thin_plate</span>(r)
    r <span style="color: #f0c674;">==</span> <span style="color: #de935f; font-weight: bold;">0.0</span> <span style="color: #f0c674;">&amp;&amp;</span> <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">0.0</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #de935f; font-weight: bold;">0.5</span> <span style="color: #f0c674;">*</span> <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">/</span>r
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<pre class="example">
dd_thin_plate (generic function with 1 method)
</pre>


<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_619abe9131ee4781bf5d0bf3274823b0>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_619abe9131ee4781bf5d0bf3274823b0=document.querySelector('button[name=btn_619abe9131ee4781bf5d0bf3274823b0]');
copyBtnbtn_619abe9131ee4781bf5d0bf3274823b0.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nX = range(0 , 1 , 100)\nY = range(-5 , 5 , 100)\n\nfig = Figure()\nax = Axis(fig[1,1])\n\nlines!(ax , X , x-> x^2 * log(x),  label=L\"T\")\nlines!(ax , X , x-> 2x * log(x) + x , label=L\"\\partial T\")\nlines!(ax , X , x-> 2log(x) + 3 , label=L\"\\partial^2 T\")\naxislegend(ax)\n\nsave(\"images/plate-spline.png\",fig )\n`);copyBtnbtn_619abe9131ee4781bf5d0bf3274823b0.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_619abe9131ee4781bf5d0bf3274823b0.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="org1b1065e"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
X = range(<span style="color: #de935f; font-weight: bold;">0</span> , <span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">100</span>)
Y = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">5</span> , <span style="color: #de935f; font-weight: bold;">5</span> , <span style="color: #de935f; font-weight: bold;">100</span>)

fig = Figure()
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: #de935f; font-weight: bold;">1</span>])

lines!(ax , X , x<span style="color: #f0c674;">-&gt;</span> x<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span> <span style="color: #f0c674;">*</span> log(x),  label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"T"</span>)
lines!(ax , X , x<span style="color: #f0c674;">-&gt;</span> <span style="color: #de935f; font-weight: bold;">2</span>x <span style="color: #f0c674;">*</span> log(x) <span style="color: #f0c674;">+</span> x , label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\partial T"</span>)
lines!(ax , X , x<span style="color: #f0c674;">-&gt;</span> <span style="color: #de935f; font-weight: bold;">2</span>log(x) <span style="color: #f0c674;">+</span> <span style="color: #de935f; font-weight: bold;">3</span> , label=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\partial^2 T"</span>)
axislegend(ax)

save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/plate-spline.png"</span>,fig )
</pre>
</div></div>


<div id="org6e4f863" class="figure">
<p><img src="images/plate-spline.png" alt="plate-spline.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org84c8526" class="outline-2">
<h2 id="org84c8526"><span class="section-number-2">4.</span> PDE</h2>
<div class="outline-text-2" id="text-4">
<p>
To use our PDE solver we include all our modules
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_24db6620f0f54d10b4c55a8c3b9804c7>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_24db6620f0f54d10b4c55a8c3b9804c7=document.querySelector('button[name=btn_24db6620f0f54d10b4c55a8c3b9804c7]');
copyBtnbtn_24db6620f0f54d10b4c55a8c3b9804c7.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using Revise\nusing LinearAlgebra\nincludet(\"src/pdesolver.jl\")\nincludet(\"src/domains.jl\")\nincludet(\"src/rbf.jl\")\nusing .PDESolvers\nusing .Domains\nusing .RadialBasisKernels\n`);copyBtnbtn_24db6620f0f54d10b4c55a8c3b9804c7.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_24db6620f0f54d10b4c55a8c3b9804c7.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> Revise
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> LinearAlgebra
includet(<span style="color: var(--clr-string); background-color: var(--bg-string);">"src/pdesolver.jl"</span>)
includet(<span style="color: var(--clr-string); background-color: var(--bg-string);">"src/domains.jl"</span>)
includet(<span style="color: var(--clr-string); background-color: var(--bg-string);">"src/rbf.jl"</span>)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> .PDESolvers
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> .Domains
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> .RadialBasisKernels
</pre>
</div></div>

<p>
and generate a set of collocation and test points. If a functional CUDA GPU is available, we move the data to the GPU. The solver will then attempt so solve on the GPU. Anoyingly all functions have to be known at compile time, when using the GPU backend.
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_d8c8b25c1bca4de9beeccb6ddfb56676>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_d8c8b25c1bca4de9beeccb6ddfb56676=document.querySelector('button[name=btn_d8c8b25c1bca4de9beeccb6ddfb56676]');
copyBtnbtn_d8c8b25c1bca4de9beeccb6ddfb56676.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using CUDA\ndev = CUDA.functional() ? cu : Array\n#dev = Array\nX = range(0 , 1 , 20)\nY = range(0 , 1 , 20)\nX_col = [ [x,y] for x in X , y in Y]\nX_col = reduce(vcat ,X_col )\nX_col = reshape(X_col, 2,:) |> dev\nX_t = range(0 , 1 , 100)\nY_t = range(0 , 1 , 100)\nX_test = [ [x,y] for x in X_t , y in Y_t]\nX_test = reduce(vcat , X_test)\nX_test = reshape(X_test, 2,:) |> dev\nX_lol = rand(2,400) |> dev\n\n\nsize(X_col)\n`);copyBtnbtn_d8c8b25c1bca4de9beeccb6ddfb56676.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_d8c8b25c1bca4de9beeccb6ddfb56676.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> CUDA
dev = CUDA.functional() <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">?</span> cu <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">:</span> Array
<span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);">#</span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">dev = Array</span>
X = range(<span style="color: #de935f; font-weight: bold;">0</span> , <span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">20</span>)
Y = range(<span style="color: #de935f; font-weight: bold;">0</span> , <span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">20</span>)
X_col = [ [x,y] <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> x in X , y <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> Y]
X_col = reduce(vcat ,X_col )
X_col = reshape(X_col, <span style="color: #de935f; font-weight: bold;">2</span>,:) <span style="color: #f0c674;">|&gt;</span> dev
X_t = range(<span style="color: #de935f; font-weight: bold;">0</span> , <span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">100</span>)
Y_t = range(<span style="color: #de935f; font-weight: bold;">0</span> , <span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">100</span>)
X_test = [ [x,y] <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> x in X_t , y <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> Y_t]
X_test = reduce(vcat , X_test)
X_test = reshape(X_test, <span style="color: #de935f; font-weight: bold;">2</span>,:) <span style="color: #f0c674;">|&gt;</span> dev
X_lol = rand(<span style="color: #de935f; font-weight: bold;">2</span>,<span style="color: #de935f; font-weight: bold;">400</span>) <span style="color: #f0c674;">|&gt;</span> dev


size(X_col)
</pre>
</div></div>

<pre class="example">
(2 400)
</pre>
</div>
<div id="outline-container-org8327160" class="outline-3">
<h3 id="org8327160"><span class="section-number-3">4.1.</span> PDE Poisson</h3>
<div class="outline-text-3" id="text-4-1">
<p>
with \(a(x) = 1 , g_{D}(x) = 0\) and \(\Gamma_{N} = \emptyset \) this method is able to model the poisson equation
</p>
\begin{align}
\label{eq:poisson}
- \Delta u(x) &= f(x) & \text{in} \quad \Omega \\
u(x) &= 0 & \text{on} \quad  \Gamma_D
\end{align}
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_590153ae5102456289497e7492105c2e>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_590153ae5102456289497e7492105c2e=document.querySelector('button[name=btn_590153ae5102456289497e7492105c2e]');
copyBtnbtn_590153ae5102456289497e7492105c2e.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using StaticArrays\nfunction domain(x::SVector{2})\n    return sdf_square(x , 0.5 , SVector(0.5,0.5))\nend\nfunction ∇domain(x::SVector{2})\n    return sdf_square_grad(x , 0.5 , SVector(0.5,0.5))\nend\nfunction sdf_β(x::SVector{2})\n    return sdf_square(x , 0. , SVector(-1.,-1) )\nend\n\na(x::SVector{2}) = 1\n∇a(x::SVector{2}) = SVector{2}(0.,0.)\nf(x::SVector{2}) =2 * (x[1]+x[2] - x[1]^2 - x[2]^2)\ng_D(x::SVector{2})= 0\ng_N(x::SVector{2} , n::SVector{2}) = 0\n`);copyBtnbtn_590153ae5102456289497e7492105c2e.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_590153ae5102456289497e7492105c2e.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> StaticArrays
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">domain</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> sdf_square(x , <span style="color: #de935f; font-weight: bold;">0.5</span> , SVector(<span style="color: #de935f; font-weight: bold;">0.5</span>,<span style="color: #de935f; font-weight: bold;">0.5</span>))
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;domain</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> sdf_square_grad(x , <span style="color: #de935f; font-weight: bold;">0.5</span> , SVector(<span style="color: #de935f; font-weight: bold;">0.5</span>,<span style="color: #de935f; font-weight: bold;">0.5</span>))
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">sdf_&#946;</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> sdf_square(x , <span style="color: #de935f; font-weight: bold;">0.</span> , SVector(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1.</span>,<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1</span>) )
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">a</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>}) = <span style="color: #de935f; font-weight: bold;">1</span>
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;a</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>}) = SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(<span style="color: #de935f; font-weight: bold;">0.</span>,<span style="color: #de935f; font-weight: bold;">0.</span>)
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">f</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>}) =<span style="color: #de935f; font-weight: bold;">2</span> <span style="color: #f0c674;">*</span> (x[<span style="color: #de935f; font-weight: bold;">1</span>]<span style="color: #f0c674;">+</span>x[<span style="color: #de935f; font-weight: bold;">2</span>] <span style="color: #f0c674;">-</span> x[<span style="color: #de935f; font-weight: bold;">1</span>]<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span> <span style="color: #f0c674;">-</span> x[<span style="color: #de935f; font-weight: bold;">2</span>]<span style="color: #f0c674;">^</span><span style="color: #de935f; font-weight: bold;">2</span>)
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">g_D</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})= <span style="color: #de935f; font-weight: bold;">0</span>
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">g_N</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>} , n<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>}) = <span style="color: #de935f; font-weight: bold;">0</span>
</pre>
</div></div>
</div>
<div id="outline-container-org12d215d" class="outline-4">
<h4 id="org12d215d"><span class="section-number-4">4.1.1.</span> Plotting Utility</h4>
<div class="outline-text-4" id="text-4-1-1">
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_6680442330fd444f87922a5e835ee66f>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_6680442330fd444f87922a5e835ee66f=document.querySelector('button[name=btn_6680442330fd444f87922a5e835ee66f]');
copyBtnbtn_6680442330fd444f87922a5e835ee66f.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using LaTeXStrings\nfunction plot(fig , i,::Val{γ} , limits , errors, rbf , d_rbf , dd_rbf) where γ\n        @inline k_rbf(x,y) = @inline k( rbf ,Val(γ), x,y)\n        @inline ∇k_rbf(x,y) =@inline ∇k(d_rbf,Val(γ), x,y)\n        @inline Δk_rbf(x,y) =@inline Δk(dd_rbf , d_rbf ,Val(γ), x,y)\n        S_gauss = PDESystem(k_rbf , ∇k_rbf , Δk_rbf , a, ∇a , f, g_D ,g_N , domain , ∇domain , sdf_β )\n        solution , K = solve(S_gauss ,X_col);\n        ax = Axis(fig[1,i] , title=L\"$\\gamma=%$γ$ Condition %$(cond(K))\", aspect=DataAspect())\n        sol , K_t = solution(X_test)\n        push!(errors , norm(Array(sol) - u.(eachcol(Array(X_test))) , Inf))\n        sol = reshape(Array(sol) , size(X_t,1) , :)\n        hm = heatmap!(ax , X,Y, sol , colorrange=limits)\n        return fig\nend\nfunction plotsq(fig , i,::Val{γ} , limits , errors, rbf , d_rbf , dd_rbf) where γ\n        @inline k_rbf(x,y) = @inline ksq( rbf ,Val(γ), x,y)\n        @inline ∇k_rbf(x,y) =@inline ∇ksq(d_rbf,Val(γ), x,y)\n        @inline Δk_rbf(x,y) =@inline Δksq(dd_rbf , d_rbf ,Val(γ), x,y)\n        S_gauss = PDESystem(k_rbf , ∇k_rbf , Δk_rbf , a, ∇a , f, g_D ,g_N , domain , ∇domain , sdf_β )\n        solution , K = solve(S_gauss ,X_col);\n        ax = Axis(fig[1,i] , title=L\"$\\gamma=%$γ$ Condition %$(cond(K))\", aspect=DataAspect())\n        sol , K_t = solution(X_test)\n        push!(errors , norm(Array(sol) - u.(eachcol(Array(X_test))) , Inf))\n        sol = reshape(Array(sol) , size(X_t,1) , :)\n        hm = heatmap!(ax , X,Y, sol , colorrange=limits)\n        return fig\nend\n`);copyBtnbtn_6680442330fd444f87922a5e835ee66f.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_6680442330fd444f87922a5e835ee66f.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> LaTeXStrings
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">plot</span>(fig , i,<span style="color: #f0c674;">::Val</span>{&#947;} , limits , errors, rbf , d_rbf , dd_rbf) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> &#947;
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">k_rbf</span>(x,y) = <span style="color: #c5c8c6; font-weight: bold;">@inline</span> k( rbf ,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#8711;k(d_rbf,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#916;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#916;k(dd_rbf , d_rbf ,Val(&#947;), x,y)
        S_gauss = PDESystem(k_rbf , &#8711;k_rbf , &#916;k_rbf , a, &#8711;a , f, g_D ,g_N , domain , &#8711;domain , sdf_&#946; )
        solution , K = solve(S_gauss ,X_col);
        ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,i] , title=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"$\gamma=%$&#947;$ Condition %$(cond(K))"</span>, aspect=DataAspect())
        sol , K_t = solution(X_test)
        push!(errors , norm(Array(sol) <span style="color: #f0c674;">-</span> u.(eachcol(Array(X_test))) , <span style="color: var(--clr-constant); background-color: var(--bg-constant);">Inf</span>))
        sol = reshape(Array(sol) , size(X_t,<span style="color: #de935f; font-weight: bold;">1</span>) , :)
        hm = heatmap!(ax , X,Y, sol , colorrange=limits)
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> fig
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">plotsq</span>(fig , i,<span style="color: #f0c674;">::Val</span>{&#947;} , limits , errors, rbf , d_rbf , dd_rbf) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> &#947;
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">k_rbf</span>(x,y) = <span style="color: #c5c8c6; font-weight: bold;">@inline</span> ksq( rbf ,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#8711;ksq(d_rbf,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#916;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#916;ksq(dd_rbf , d_rbf ,Val(&#947;), x,y)
        S_gauss = PDESystem(k_rbf , &#8711;k_rbf , &#916;k_rbf , a, &#8711;a , f, g_D ,g_N , domain , &#8711;domain , sdf_&#946; )
        solution , K = solve(S_gauss ,X_col);
        ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,i] , title=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"$\gamma=%$&#947;$ Condition %$(cond(K))"</span>, aspect=DataAspect())
        sol , K_t = solution(X_test)
        push!(errors , norm(Array(sol) <span style="color: #f0c674;">-</span> u.(eachcol(Array(X_test))) , <span style="color: var(--clr-constant); background-color: var(--bg-constant);">Inf</span>))
        sol = reshape(Array(sol) , size(X_t,<span style="color: #de935f; font-weight: bold;">1</span>) , :)
        hm = heatmap!(ax , X,Y, sol , colorrange=limits)
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> fig
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<pre class="example">
plotsq (generic function with 1 method)
</pre>
</div>
</div>
<div id="outline-container-org4ea9556" class="outline-4">
<h4 id="org4ea9556"><span class="section-number-4">4.1.2.</span> Results</h4>
<div class="outline-text-4" id="text-4-1-2">
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_21949e6b67fc4aa1a6706e18ca55d739>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_21949e6b67fc4aa1a6706e18ca55d739=document.querySelector('button[name=btn_21949e6b67fc4aa1a6706e18ca55d739]');
copyBtnbtn_21949e6b67fc4aa1a6706e18ca55d739.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nfig = Figure(size=(2600,400))\nlimits = (0, 0.06)\nerrors = Vector{Float32}()\nu(x , y) = x * (1-x) * y* ( 1- y)\nu(x) = u(x[1] , x[2])\nfor (i,gamma) in enumerate([Val(0.1) , Val(0.075) , Val(0.05) , Val(0.025)])\nplotsq(fig , i,gamma , limits , errors , rbf_gaussian , d_rbf_gaussian , dd_rbf_gaussian)\nend\nax = Axis(fig[1,0] , title=\"Exact sollution\" , aspect=DataAspect())\nhm = heatmap!(ax,X_t,Y_t,u , colorrange=limits)\nColorbar(fig[:, end+1], hm)\nax = Axis(fig[1,end+1] , title=L\"$L^\\infty$ Error\" , xlabel=L\"\\gamma\" , ylabel=L\"|u_h - u |_\\infty\")\nlines!(ax , [0.01 , 0.0075 , 0.005 , 0.0025] , errors)\nsave(\"images/gauss-kernel.png\",fig )\n`);copyBtnbtn_21949e6b67fc4aa1a6706e18ca55d739.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_21949e6b67fc4aa1a6706e18ca55d739.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="orge4aacd6"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
fig = Figure(size=(<span style="color: #de935f; font-weight: bold;">2600</span>,<span style="color: #de935f; font-weight: bold;">400</span>))
limits = (<span style="color: #de935f; font-weight: bold;">0</span>, <span style="color: #de935f; font-weight: bold;">0.06</span>)
errors = Vector{Float32}()
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">u</span>(x , y) = x <span style="color: #f0c674;">*</span> (<span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">-</span>x) <span style="color: #f0c674;">*</span> y<span style="color: #f0c674;">*</span> ( <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">-</span> y)
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">u</span>(x) = u(x[<span style="color: #de935f; font-weight: bold;">1</span>] , x[<span style="color: #de935f; font-weight: bold;">2</span>])
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> (i,gamma) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> enumerate([Val(<span style="color: #de935f; font-weight: bold;">0.1</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.075</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.05</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.025</span>)])
plotsq(fig , i,gamma , limits , errors , rbf_gaussian , d_rbf_gaussian , dd_rbf_gaussian)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: #de935f; font-weight: bold;">0</span>] , title=<span style="color: var(--clr-string); background-color: var(--bg-string);">"Exact sollution"</span> , aspect=DataAspect())
hm = heatmap!(ax,X_t,Y_t,u , colorrange=limits)
Colorbar(fig[:, <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>], hm)
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>] , title=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"$L^\infty$ Error"</span> , xlabel=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\gamma"</span> , ylabel=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"|u_h - u |_\infty"</span>)
lines!(ax , [<span style="color: #de935f; font-weight: bold;">0.01</span> , <span style="color: #de935f; font-weight: bold;">0.0075</span> , <span style="color: #de935f; font-weight: bold;">0.005</span> , <span style="color: #de935f; font-weight: bold;">0.0025</span>] , errors)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/gauss-kernel.png"</span>,fig )
</pre>
</div></div>


<div id="org62c5482" class="figure">
<p><img src="images/gauss-kernel.png" alt="gauss-kernel.png" />
</p>
<p><span class="figure-number">Figure 1: </span>gauss kernel with various values for \(\gamma \)</p>
</div>

<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_b52e4d26a854421fba098b229dfc978b>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_b52e4d26a854421fba098b229dfc978b=document.querySelector('button[name=btn_b52e4d26a854421fba098b229dfc978b]');
copyBtnbtn_b52e4d26a854421fba098b229dfc978b.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nfig = Figure(size=(2600,400))\nlimits = (0, 0.06)\nerrors = Vector{Float32}()\nfor (i,gamma) in enumerate([Val(1.0) , Val(0.1) , Val(0.05) , Val(0.01)])\nplotsq(fig , i,gamma , limits , errors , thin_plate , d_thin_plate , dd_thin_plate)\nend\nu(x , y) = x * (1-x) * y* ( 1- y)\nu(x) = u(x[1] , x[2])\nax = Axis(fig[1,0] , title=\"Exact sollution\" , aspect=DataAspect())\nhm = heatmap!(ax,X_t,Y_t,u , colorrange=limits)\nColorbar(fig[:, end+1], hm)\nax = Axis(fig[1,end+1] , title=L\"$L^\\infty$ Error\" , xlabel=L\"\\gamma\" , ylabel=L\"|u_h - u |_\\infty\")\nlines!(ax , [1.,0.1,0.05,0.01] , errors)\nsave(\"images/thin-plate-kernel.png\",fig )\n`);copyBtnbtn_b52e4d26a854421fba098b229dfc978b.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_b52e4d26a854421fba098b229dfc978b.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="org5710ee2"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
fig = Figure(size=(<span style="color: #de935f; font-weight: bold;">2600</span>,<span style="color: #de935f; font-weight: bold;">400</span>))
limits = (<span style="color: #de935f; font-weight: bold;">0</span>, <span style="color: #de935f; font-weight: bold;">0.06</span>)
errors = Vector{Float32}()
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> (i,gamma) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> enumerate([Val(<span style="color: #de935f; font-weight: bold;">1.0</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.1</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.05</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.01</span>)])
plotsq(fig , i,gamma , limits , errors , thin_plate , d_thin_plate , dd_thin_plate)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">u</span>(x , y) = x <span style="color: #f0c674;">*</span> (<span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">-</span>x) <span style="color: #f0c674;">*</span> y<span style="color: #f0c674;">*</span> ( <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">-</span> y)
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">u</span>(x) = u(x[<span style="color: #de935f; font-weight: bold;">1</span>] , x[<span style="color: #de935f; font-weight: bold;">2</span>])
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: #de935f; font-weight: bold;">0</span>] , title=<span style="color: var(--clr-string); background-color: var(--bg-string);">"Exact sollution"</span> , aspect=DataAspect())
hm = heatmap!(ax,X_t,Y_t,u , colorrange=limits)
Colorbar(fig[:, <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>], hm)
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>] , title=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"$L^\infty$ Error"</span> , xlabel=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\gamma"</span> , ylabel=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"|u_h - u |_\infty"</span>)
lines!(ax , [<span style="color: #de935f; font-weight: bold;">1.</span>,<span style="color: #de935f; font-weight: bold;">0.1</span>,<span style="color: #de935f; font-weight: bold;">0.05</span>,<span style="color: #de935f; font-weight: bold;">0.01</span>] , errors)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/thin-plate-kernel.png"</span>,fig )
</pre>
</div></div>


<div id="orge24c878" class="figure">
<p><img src="images/thin-plate-kernel.png" alt="thin-plate-kernel.png" />
</p>
</div>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_2b2f9a93503045818e7f81c882223bc2>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_2b2f9a93503045818e7f81c882223bc2=document.querySelector('button[name=btn_2b2f9a93503045818e7f81c882223bc2]');
copyBtnbtn_2b2f9a93503045818e7f81c882223bc2.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nfig = Figure(size=(2600,400))\nlimits = (0, 0.06)\nerrors = Vector{Float32}()\nfor (i,gamma) in enumerate([Val(0.5) , Val(1.0) , Val(1.5) , Val(2.0)])\nplot(fig , i,gamma , limits , errors , B_3 , d_B_3 , dd_B_3)\nend\nu(x , y) = x * (1-x) * y* ( 1- y)\nu(x) = u(x[1] , x[2])\nax = Axis(fig[1,0] , title=\"Exact sollution\" , aspect=DataAspect())\nhm = heatmap!(ax,X_t,Y_t,u , colorrange=limits)\nColorbar(fig[:, end+1], hm)\nax = Axis(fig[1,end+1] , title=L\"$L^\\infty$ Error\" , xlabel=L\"\\gamma\" , ylabel=L\"|u_h - u |_\\infty\")\nlines!(ax , [0.5,1.,1.5,2.] , errors)\nsave(\"images/B3-spline-kernel.png\",fig )\n`);copyBtnbtn_2b2f9a93503045818e7f81c882223bc2.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_2b2f9a93503045818e7f81c882223bc2.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="org9c53fd0"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
fig = Figure(size=(<span style="color: #de935f; font-weight: bold;">2600</span>,<span style="color: #de935f; font-weight: bold;">400</span>))
limits = (<span style="color: #de935f; font-weight: bold;">0</span>, <span style="color: #de935f; font-weight: bold;">0.06</span>)
errors = Vector{Float32}()
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> (i,gamma) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> enumerate([Val(<span style="color: #de935f; font-weight: bold;">0.5</span>) , Val(<span style="color: #de935f; font-weight: bold;">1.0</span>) , Val(<span style="color: #de935f; font-weight: bold;">1.5</span>) , Val(<span style="color: #de935f; font-weight: bold;">2.0</span>)])
plot(fig , i,gamma , limits , errors , B_3 , d_B_3 , dd_B_3)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">u</span>(x , y) = x <span style="color: #f0c674;">*</span> (<span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">-</span>x) <span style="color: #f0c674;">*</span> y<span style="color: #f0c674;">*</span> ( <span style="color: #de935f; font-weight: bold;">1</span><span style="color: #f0c674;">-</span> y)
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">u</span>(x) = u(x[<span style="color: #de935f; font-weight: bold;">1</span>] , x[<span style="color: #de935f; font-weight: bold;">2</span>])
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: #de935f; font-weight: bold;">0</span>] , title=<span style="color: var(--clr-string); background-color: var(--bg-string);">"Exact sollution"</span> , aspect=DataAspect())
hm = heatmap!(ax,X_t,Y_t,u , colorrange=limits)
Colorbar(fig[:, <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>], hm)
ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>] , title=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"$L^\infty$ Error"</span> , xlabel=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"\gamma"</span> , ylabel=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"|u_h - u |_\infty"</span>)
lines!(ax , [<span style="color: #de935f; font-weight: bold;">0.5</span>,<span style="color: #de935f; font-weight: bold;">1.</span>,<span style="color: #de935f; font-weight: bold;">1.5</span>,<span style="color: #de935f; font-weight: bold;">2.</span>] , errors)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/B3-spline-kernel.png"</span>,fig )
</pre>
</div></div>


<div id="org4f05da7" class="figure">
<p><img src="images/B3-spline-kernel.png" alt="B3-spline-kernel.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org1c207d9" class="outline-3">
<h3 id="org1c207d9"><span class="section-number-3">4.2.</span> Diffusion PDE</h3>
<div class="outline-text-3" id="text-4-2">
<p>
we evaluate the diffusion PDE with
</p>
\begin{align*}
a(x) &=  x_1 +2 \\
f(x) &= - \alpha \|x\|^{\alpha -2} * (3x_1 + 4) - \alpha * (\alpha -2) * (x_1 +2) * \|x\|^{\alpha -3} \\
g_D(x) &= \|x\|^{\alpha }\\
g_{N}(x,n) &= \alpha  \|x\|^{\alpha -2}* (x_1 +2) * x \cdot  n
\end{align*}
<p>
where
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_f403dbe2f28b41f780c794376f0f71a9>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_f403dbe2f28b41f780c794376f0f71a9=document.querySelector('button[name=btn_f403dbe2f28b41f780c794376f0f71a9]');
copyBtnbtn_f403dbe2f28b41f780c794376f0f71a9.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using StaticArrays\na(x::SVector{2}) = x[1] + 2\n∇a(x::SVector{2}) = SVector{2}(1.,0.)\nα = 0.5\nβ = 0.2\nf(x::SVector{2} , ::Val{α}) where α = - α*norm(x ,2)^(α - 2)*(3x[1] +4) - α*(α -2) * (x[1] + 2) * norm(x,2)^(α - 3)\ng_D(x::SVector{2} , ::Val{α}) where α = norm(x,2)^α\ng_N(x::SVector{2} , n::SVector{2} , ::Val{α}) where α = α* norm(x,2.)^(α-2.)*(x[1] +2.) * x ⋅ n\nf(x) = f(x,Val(α))\ng_D(x) = g_D(x,Val(α))\ng_N(x, n) = g_N(x , n,Val(α))\nfunction sdf_β(x::SVector{2})\n    return sdf_square(x , β , SVector(-1.,-1) )\nend\n`);copyBtnbtn_f403dbe2f28b41f780c794376f0f71a9.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_f403dbe2f28b41f780c794376f0f71a9.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> StaticArrays
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">a</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>}) = x[<span style="color: #de935f; font-weight: bold;">1</span>] <span style="color: #f0c674;">+</span> <span style="color: #de935f; font-weight: bold;">2</span>
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;a</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>}) = SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(<span style="color: #de935f; font-weight: bold;">1.</span>,<span style="color: #de935f; font-weight: bold;">0.</span>)
&#945; = <span style="color: #de935f; font-weight: bold;">0.5</span>
&#946; = <span style="color: #de935f; font-weight: bold;">0.2</span>
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">f</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>} , <span style="color: #f0c674;">::Val</span>{&#945;}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> &#945; = <span style="color: #f0c674;">-</span> &#945;<span style="color: #f0c674;">*</span>norm(x ,<span style="color: #de935f; font-weight: bold;">2</span>)<span style="color: #f0c674;">^</span>(&#945; <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">2</span>)<span style="color: #f0c674;">*</span>(<span style="color: #de935f; font-weight: bold;">3</span>x[<span style="color: #de935f; font-weight: bold;">1</span>] <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">4</span>) <span style="color: #f0c674;">-</span> &#945;<span style="color: #f0c674;">*</span>(&#945; <span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">2</span>) <span style="color: #f0c674;">*</span> (x[<span style="color: #de935f; font-weight: bold;">1</span>] <span style="color: #f0c674;">+</span> <span style="color: #de935f; font-weight: bold;">2</span>) <span style="color: #f0c674;">*</span> norm(x,<span style="color: #de935f; font-weight: bold;">2</span>)<span style="color: #f0c674;">^</span>(&#945; <span style="color: #f0c674;">-</span> <span style="color: #de935f; font-weight: bold;">3</span>)
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">g_D</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>} , <span style="color: #f0c674;">::Val</span>{&#945;}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> &#945; = norm(x,<span style="color: #de935f; font-weight: bold;">2</span>)<span style="color: #f0c674;">^</span>&#945;
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">g_N</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>} , n<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>} , <span style="color: #f0c674;">::Val</span>{&#945;}) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> &#945; = &#945;<span style="color: #f0c674;">*</span> norm(x,<span style="color: #de935f; font-weight: bold;">2.</span>)<span style="color: #f0c674;">^</span>(&#945;<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">2.</span>)<span style="color: #f0c674;">*</span>(x[<span style="color: #de935f; font-weight: bold;">1</span>] <span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">2.</span>) <span style="color: #f0c674;">*</span> x &#8901; n
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">f</span>(x) = f(x,Val(&#945;))
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">g_D</span>(x) = g_D(x,Val(&#945;))
<span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">g_N</span>(x, n) = g_N(x , n,Val(&#945;))
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">sdf_&#946;</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> sdf_square(x , &#946; , SVector(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1.</span>,<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1</span>) )
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<pre class="example">
sdf_β (generic function with 1 method)
</pre>


<p>
And select a collocation set filtered to be inside the domain
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_76481a9200fb48b6aa4a25f37e2e4dad>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_76481a9200fb48b6aa4a25f37e2e4dad=document.querySelector('button[name=btn_76481a9200fb48b6aa4a25f37e2e4dad]');
copyBtnbtn_76481a9200fb48b6aa4a25f37e2e4dad.addEventListener('click', function(event) {
let res = copyTextToClipboard(`X = range(-1 , 1 , 11)\nY = range(-1 , 1 , 11)\nX_col = [ [x,y] for x in X , y in Y]\nX_col = reduce(vcat ,X_col )\nX_col = reshape(X_col, 2,:)\nX_col = filter(x -> sdf_L(SVector{2}(x)) <= 0 , eachcol(X_col))\nX_col = reduce(hcat , X_col) |> dev\nX_t = range(-1.1 , 1.1 , 100)\nY_t = range(-1.1, 1.1 , 100)\nX_test = [ [x,y] for x in X_t , y in Y_t]\nX_test = reduce(vcat , X_test)\nX_test = reshape(X_test, 2,:) |> dev\nsize(X_col)\n`);copyBtnbtn_76481a9200fb48b6aa4a25f37e2e4dad.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_76481a9200fb48b6aa4a25f37e2e4dad.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia">X = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">11</span>)
Y = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">1</span> , <span style="color: #de935f; font-weight: bold;">11</span>)
X_col = [ [x,y] <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> x in X , y <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> Y]
X_col = reduce(vcat ,X_col )
X_col = reshape(X_col, <span style="color: #de935f; font-weight: bold;">2</span>,:)
X_col = filter(x <span style="color: #f0c674;">-&gt;</span> sdf_L(SVector{<span style="color: #de935f; font-weight: bold;">2</span>}(x)) <span style="color: #f0c674;">&lt;=</span> <span style="color: #de935f; font-weight: bold;">0</span> , eachcol(X_col))
X_col = reduce(hcat , X_col) <span style="color: #f0c674;">|&gt;</span> dev
X_t = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1.1</span> , <span style="color: #de935f; font-weight: bold;">1.1</span> , <span style="color: #de935f; font-weight: bold;">100</span>)
Y_t = range(<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">1.1</span>, <span style="color: #de935f; font-weight: bold;">1.1</span> , <span style="color: #de935f; font-weight: bold;">100</span>)
X_test = [ [x,y] <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> x in X_t , y <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> Y_t]
X_test = reduce(vcat , X_test)
X_test = reshape(X_test, <span style="color: #de935f; font-weight: bold;">2</span>,:) <span style="color: #f0c674;">|&gt;</span> dev
size(X_col)
</pre>
</div></div>

<pre class="example">
(2 96)
</pre>
</div>
<div id="outline-container-org002fa9c" class="outline-4">
<h4 id="org002fa9c"><span class="section-number-4">4.2.1.</span> Plotting utility</h4>
<div class="outline-text-4" id="text-4-2-1">
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_5d66aebf6dc94cdeaf33772b938c1a90>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_5d66aebf6dc94cdeaf33772b938c1a90=document.querySelector('button[name=btn_5d66aebf6dc94cdeaf33772b938c1a90]');
copyBtnbtn_5d66aebf6dc94cdeaf33772b938c1a90.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using LaTeXStrings\nfunction plotdiff(fig , i,::Val{γ} , limits ,  rbf , d_rbf , dd_rbf) where γ\n        @inline k_rbf(x,y) = @inline k( rbf ,Val(γ), x,y)\n        @inline ∇k_rbf(x,y) =@inline ∇k(d_rbf,Val(γ), x,y)\n        @inline Δk_rbf(x,y) =@inline Δk(dd_rbf , d_rbf ,Val(γ), x,y)\n        S_gauss = PDESystem(k_rbf , ∇k_rbf , Δk_rbf , a, ∇a , f, g_D ,g_N , sdf_L , sdf_L_grad , sdf_β )\n        solution , K = solve(S_gauss ,X_col);\n        ax = Axis(fig[1,i] , title=L\"$\\gamma=%$γ$ Condition %$(cond(K))\", aspect=DataAspect())\n        sol , K_t = solution(X_test)\n        push!(errors , norm(Array(sol) - u.(eachcol(Array(X_test))) , Inf))\n        sol = reshape(Array(sol) , size(X_t,1) , :)\n        hm = heatmap!(ax , X,Y, sol , colorrange=limits)\n        return fig\nend\nfunction plotsqdiff(fig , i,::Val{γ} , limits , rbf , d_rbf , dd_rbf) where γ\n        @inline k_rbf(x,y) = @inline ksq( rbf ,Val(γ), x,y)\n        @inline ∇k_rbf(x,y) =@inline ∇ksq(d_rbf,Val(γ), x,y)\n        @inline Δk_rbf(x,y) =@inline Δksq(dd_rbf , d_rbf ,Val(γ), x,y)\n        S_gauss = PDESystem(k_rbf , ∇k_rbf , Δk_rbf , a, ∇a , f, g_D ,g_N , sdf_L , sdf_L_grad , sdf_β )\n        solution , K = solve(S_gauss ,X_col);\n        ax = Axis(fig[1,i] , title=L\"$\\gamma=%$γ$ Condition %$(cond(K))\", aspect=DataAspect())\n        sol , K_t = solution(X_test)\n        push!(errors , norm(Array(sol) - u.(eachcol(Array(X_test))) , Inf))\n        sol = reshape(Array(sol) , size(X_t,1) , :)\n        hm = heatmap!(ax , X,Y, sol , colorrange=limits)\n        return fig\nend\n`);copyBtnbtn_5d66aebf6dc94cdeaf33772b938c1a90.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_5d66aebf6dc94cdeaf33772b938c1a90.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> LaTeXStrings
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">plotdiff</span>(fig , i,<span style="color: #f0c674;">::Val</span>{&#947;} , limits ,  rbf , d_rbf , dd_rbf) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> &#947;
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">k_rbf</span>(x,y) = <span style="color: #c5c8c6; font-weight: bold;">@inline</span> k( rbf ,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#8711;k(d_rbf,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#916;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#916;k(dd_rbf , d_rbf ,Val(&#947;), x,y)
        S_gauss = PDESystem(k_rbf , &#8711;k_rbf , &#916;k_rbf , a, &#8711;a , f, g_D ,g_N , sdf_L , sdf_L_grad , sdf_&#946; )
        solution , K = solve(S_gauss ,X_col);
        ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,i] , title=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"$\gamma=%$&#947;$ Condition %$(cond(K))"</span>, aspect=DataAspect())
        sol , K_t = solution(X_test)
        push!(errors , norm(Array(sol) <span style="color: #f0c674;">-</span> u.(eachcol(Array(X_test))) , <span style="color: var(--clr-constant); background-color: var(--bg-constant);">Inf</span>))
        sol = reshape(Array(sol) , size(X_t,<span style="color: #de935f; font-weight: bold;">1</span>) , :)
        hm = heatmap!(ax , X,Y, sol , colorrange=limits)
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> fig
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">plotsqdiff</span>(fig , i,<span style="color: #f0c674;">::Val</span>{&#947;} , limits , rbf , d_rbf , dd_rbf) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">where</span> &#947;
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">k_rbf</span>(x,y) = <span style="color: #c5c8c6; font-weight: bold;">@inline</span> ksq( rbf ,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#8711;ksq(d_rbf,Val(&#947;), x,y)
        <span style="color: #c5c8c6; font-weight: bold;">@inline</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#916;k_rbf</span>(x,y) =<span style="color: #c5c8c6; font-weight: bold;">@inline</span> &#916;ksq(dd_rbf , d_rbf ,Val(&#947;), x,y)
        S_gauss = PDESystem(k_rbf , &#8711;k_rbf , &#916;k_rbf , a, &#8711;a , f, g_D ,g_N , sdf_L , sdf_L_grad , sdf_&#946; )
        solution , K = solve(S_gauss ,X_col);
        ax = Axis(fig[<span style="color: #de935f; font-weight: bold;">1</span>,i] , title=L<span style="color: var(--clr-string); background-color: var(--bg-string);">"$\gamma=%$&#947;$ Condition %$(cond(K))"</span>, aspect=DataAspect())
        sol , K_t = solution(X_test)
        push!(errors , norm(Array(sol) <span style="color: #f0c674;">-</span> u.(eachcol(Array(X_test))) , <span style="color: var(--clr-constant); background-color: var(--bg-constant);">Inf</span>))
        sol = reshape(Array(sol) , size(X_t,<span style="color: #de935f; font-weight: bold;">1</span>) , :)
        hm = heatmap!(ax , X,Y, sol , colorrange=limits)
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> fig
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>

<pre class="example">
plotsqdiff (generic function with 1 method)
</pre>
</div>
</div>
<div id="outline-container-org98f5047" class="outline-4">
<h4 id="org98f5047"><span class="section-number-4">4.2.2.</span> Results</h4>
<div class="outline-text-4" id="text-4-2-2">
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_4e8f9eec5878455ea259e8691b8366a8>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_4e8f9eec5878455ea259e8691b8366a8=document.querySelector('button[name=btn_4e8f9eec5878455ea259e8691b8366a8]');
copyBtnbtn_4e8f9eec5878455ea259e8691b8366a8.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nfig = Figure(size=(1800,400))\nlimits = (-0.6, 0)\nfor (i,gamma) in enumerate([Val(0.1) , Val(0.075) , Val(0.05) , Val(0.025)])\nplotsqdiff(fig , i,gamma , limits , rbf_gaussian , d_rbf_gaussian , dd_rbf_gaussian)\nend\nColorbar(fig[:, end+1], hm)\nsave(\"images/gauss-kernel-diff.png\",fig )\n`);copyBtnbtn_4e8f9eec5878455ea259e8691b8366a8.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_4e8f9eec5878455ea259e8691b8366a8.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="org1368bba"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
fig = Figure(size=(<span style="color: #de935f; font-weight: bold;">1800</span>,<span style="color: #de935f; font-weight: bold;">400</span>))
limits = (<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">0.6</span>, <span style="color: #de935f; font-weight: bold;">0</span>)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> (i,gamma) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> enumerate([Val(<span style="color: #de935f; font-weight: bold;">0.1</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.075</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.05</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.025</span>)])
plotsqdiff(fig , i,gamma , limits , rbf_gaussian , d_rbf_gaussian , dd_rbf_gaussian)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
Colorbar(fig[:, <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>], hm)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/gauss-kernel-diff.png"</span>,fig )
</pre>
</div></div>


<div id="org04720f7" class="figure">
<p><img src="images/gauss-kernel-diff.png" alt="gauss-kernel-diff.png" />
</p>
<p><span class="figure-number">Figure 2: </span>gauss kernel with various values for \(\gamma \) for a diffusive system</p>
</div>



<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_44fcb3c6d2324e57976f7bb41ab18258>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_44fcb3c6d2324e57976f7bb41ab18258=document.querySelector('button[name=btn_44fcb3c6d2324e57976f7bb41ab18258]');
copyBtnbtn_44fcb3c6d2324e57976f7bb41ab18258.addEventListener('click', function(event) {
let res = copyTextToClipboard(`fig = Figure(size=(1800,400))\nlimits = (-0.6, 0)\nfor (i,gamma) in enumerate([Val(0.1) , Val(0.075) , Val(0.05) , Val(0.025)])\nplotsqdiff(fig , i,gamma , limits , thin_plate , d_thin_plate , dd_thin_plate)\nend\nColorbar(fig[:, end+1], hm)\nsave(\"images/thin-plate-kernel-diff.png\",fig )\n`);copyBtnbtn_44fcb3c6d2324e57976f7bb41ab18258.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_44fcb3c6d2324e57976f7bb41ab18258.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="orga77b753">fig = Figure(size=(<span style="color: #de935f; font-weight: bold;">1800</span>,<span style="color: #de935f; font-weight: bold;">400</span>))
limits = (<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">0.6</span>, <span style="color: #de935f; font-weight: bold;">0</span>)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> (i,gamma) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> enumerate([Val(<span style="color: #de935f; font-weight: bold;">0.1</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.075</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.05</span>) , Val(<span style="color: #de935f; font-weight: bold;">0.025</span>)])
plotsqdiff(fig , i,gamma , limits , thin_plate , d_thin_plate , dd_thin_plate)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
Colorbar(fig[:, <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>], hm)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/thin-plate-kernel-diff.png"</span>,fig )
</pre>
</div></div>


<div id="orgb838dae" class="figure">
<p><img src="images/thin-plate-kernel-diff.png" alt="thin-plate-kernel-diff.png" />
</p>
<p><span class="figure-number">Figure 3: </span>thin plate kernel with various values for \(\gamma \) for a diffusive system</p>
</div>

<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_2d6eaa2bf2da4f03847f17e3bc3e0663>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_2d6eaa2bf2da4f03847f17e3bc3e0663=document.querySelector('button[name=btn_2d6eaa2bf2da4f03847f17e3bc3e0663]');
copyBtnbtn_2d6eaa2bf2da4f03847f17e3bc3e0663.addEventListener('click', function(event) {
let res = copyTextToClipboard(`using GLMakie\nfig = Figure(size=(1800,400))\nlimits = (-0.6, 0)\nfor (i,gamma) in enumerate([Val(1.0) , Val(1.25) , Val(1.5) , Val(1.75)])\nplotsqdiff(fig , i,gamma , limits , B_3 , d_B_3 , dd_B_3)\nend\nColorbar(fig[:, end+1], hm)\nsave(\"images/B3-spline-kernel-diff.png\",fig )\n`);copyBtnbtn_2d6eaa2bf2da4f03847f17e3bc3e0663.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_2d6eaa2bf2da4f03847f17e3bc3e0663.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia" id="org86477cd"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">using</span> GLMakie
fig = Figure(size=(<span style="color: #de935f; font-weight: bold;">1800</span>,<span style="color: #de935f; font-weight: bold;">400</span>))
limits = (<span style="color: #f0c674;">-</span><span style="color: #de935f; font-weight: bold;">0.6</span>, <span style="color: #de935f; font-weight: bold;">0</span>)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">for</span> (i,gamma) <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">in</span> enumerate([Val(<span style="color: #de935f; font-weight: bold;">1.0</span>) , Val(<span style="color: #de935f; font-weight: bold;">1.25</span>) , Val(<span style="color: #de935f; font-weight: bold;">1.5</span>) , Val(<span style="color: #de935f; font-weight: bold;">1.75</span>)])
plotsqdiff(fig , i,gamma , limits , B_3 , d_B_3 , dd_B_3)
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
Colorbar(fig[:, <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span><span style="color: #f0c674;">+</span><span style="color: #de935f; font-weight: bold;">1</span>], hm)
save(<span style="color: var(--clr-string); background-color: var(--bg-string);">"images/B3-spline-kernel-diff.png"</span>,fig )
</pre>
</div></div>
</div>
</div>
</div>
</div>
<div id="outline-container-org7c8c323" class="outline-2">
<h2 id="org7c8c323"><span class="section-number-2">5.</span> Domains</h2>
<div class="outline-text-2" id="text-5">
<p>
We define our domains using signed distance functions (SDF) and their gradients.
The SDF of a unit square centered on \(c \in \RR^{n}\) is given by the \(L^{\infty }\) norm
</p>
\begin{align*}
\text{sdf}(x) = \|x - c\|_{\infty}
\end{align*}
<p>
The gradient was calculated analytically and imlpemented as:
</p>
<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_9d4017bf25cd4dc3ab61cf19b2ea1639>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_9d4017bf25cd4dc3ab61cf19b2ea1639=document.querySelector('button[name=btn_9d4017bf25cd4dc3ab61cf19b2ea1639]');
copyBtnbtn_9d4017bf25cd4dc3ab61cf19b2ea1639.addEventListener('click', function(event) {
let res = copyTextToClipboard(`\nfunction sdf_square(x::SVector , r::Float64 , center::SVector)\n    return norm(x-center,Inf) .- r\nend\nfunction sdf_square_grad(x::SVector{2}, r::Float64, center::SVector{2})\n    d = x - center\n    if abs(d[1]) > abs(d[2])\n        return SVector(sign(d[1]), 0.0)\n    elseif abs(d[2]) > abs(d[1])\n        return SVector(0.0, sign(d[2]))\n    else\n        # Subgradient: pick any valid direction; here we average the two\n        return normalize(SVector(sign(d[1]), sign(d[2])))\n    end\nend\n`);copyBtnbtn_9d4017bf25cd4dc3ab61cf19b2ea1639.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_9d4017bf25cd4dc3ab61cf19b2ea1639.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia">
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">sdf_square</span>(x<span style="color: #f0c674;">::SVector</span> , r<span style="color: #f0c674;">::Float64</span> , center<span style="color: #f0c674;">::SVector</span>)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> norm(x<span style="color: #f0c674;">-</span>center,<span style="color: var(--clr-constant); background-color: var(--bg-constant);">Inf</span>) .<span style="color: #f0c674;">-</span> r
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">sdf_square_grad</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>}, r<span style="color: #f0c674;">::Float64</span>, center<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    d = x <span style="color: #f0c674;">-</span> center
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">if</span> abs(d[<span style="color: #de935f; font-weight: bold;">1</span>]) <span style="color: #f0c674;">&gt;</span> abs(d[<span style="color: #de935f; font-weight: bold;">2</span>])
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> SVector(sign(d[<span style="color: #de935f; font-weight: bold;">1</span>]), <span style="color: #de935f; font-weight: bold;">0.0</span>)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">elseif</span> abs(d[<span style="color: #de935f; font-weight: bold;">2</span>]) <span style="color: #f0c674;">&gt;</span> abs(d[<span style="color: #de935f; font-weight: bold;">1</span>])
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> SVector(<span style="color: #de935f; font-weight: bold;">0.0</span>, sign(d[<span style="color: #de935f; font-weight: bold;">2</span>]))
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">else</span>
        <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Subgradient: pick any valid direction; here we average the two</span>
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> normalize(SVector(sign(d[<span style="color: #de935f; font-weight: bold;">1</span>]), sign(d[<span style="color: #de935f; font-weight: bold;">2</span>])))
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>
<p>
The L shaped Domain can be described by intersecting 2 square SDF centered on \(c = (0,0)\)
</p>

\begin{align*}
sdf(\Omega_1 \ \Omega_2) &= \max(sdf(\Omega_1) , -sdf(\Omega_2))
\end{align*}

<div class='org-src-wrapper'>
<div class='org-src-bar'><span class='srcLangLabel'>JULIA</span><button class='copyBtn' name=btn_4a6e21f6dc4c4b46bdd5e7b767059f0f>&#10697;</button>
<script type='text/javascript'>
var copyBtnbtn_4a6e21f6dc4c4b46bdd5e7b767059f0f=document.querySelector('button[name=btn_4a6e21f6dc4c4b46bdd5e7b767059f0f]');
copyBtnbtn_4a6e21f6dc4c4b46bdd5e7b767059f0f.addEventListener('click', function(event) {
let res = copyTextToClipboard(`function sdf_L(x::SVector{2})\n    return max(sdf_square(x , 1. , SVector(0,0)) , - sdf_square(x, 1. , SVector(1.,1.)))\nend\n\nfunction ∇sdf_L(x::SVector{2})\n    ForwardDiff.gradient(sdf_L , x)\n    return\nend\n\n\nfunction sdf_L_grad(x::SVector{2})\n    f1 = sdf_square(x, 1.0, SVector(0.0, 0.0))\n    f2 = -sdf_square(x, 1.0, SVector(1.0, 1.0))\n\n    if f1 > f2\n        return sdf_square_grad(x, 1.0, SVector(0.0, 0.0))\n    elseif f2 > f1\n        return -sdf_square_grad(x, 1.0, SVector(1.0, 1.0))  # negative because of the minus\n    else\n        # Subgradient — average of both directions\n        g1 = sdf_square_grad(x, 1.0, SVector(0.0, 0.0))\n        g2 = -sdf_square_grad(x, 1.0, SVector(1.0, 1.0))\n        return normalize(g1 + g2)\n    end\nend\n`);copyBtnbtn_4a6e21f6dc4c4b46bdd5e7b767059f0f.innerHTML = res ? '&#10003;' : 'error';setTimeout(() => { copyBtnbtn_4a6e21f6dc4c4b46bdd5e7b767059f0f.innerHTML = '&#10697;'}, 3000);
});
</script>
</div><div class="org-src-container">
<pre class="src src-julia"><span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">sdf_L</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> max(sdf_square(x , <span style="color: #de935f; font-weight: bold;">1.</span> , SVector(<span style="color: #de935f; font-weight: bold;">0</span>,<span style="color: #de935f; font-weight: bold;">0</span>)) , <span style="color: #f0c674;">-</span> sdf_square(x, <span style="color: #de935f; font-weight: bold;">1.</span> , SVector(<span style="color: #de935f; font-weight: bold;">1.</span>,<span style="color: #de935f; font-weight: bold;">1.</span>)))
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>

<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">&#8711;sdf_L</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    ForwardDiff.gradient(sdf_L , x)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>


<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">function</span> <span style="color: var(--function-clr-name); background-color: var(--function-bg-name);">sdf_L_grad</span>(x<span style="color: #f0c674;">::SVector</span>{<span style="color: #de935f; font-weight: bold;">2</span>})
    f1 = sdf_square(x, <span style="color: #de935f; font-weight: bold;">1.0</span>, SVector(<span style="color: #de935f; font-weight: bold;">0.0</span>, <span style="color: #de935f; font-weight: bold;">0.0</span>))
    f2 = <span style="color: #f0c674;">-</span>sdf_square(x, <span style="color: #de935f; font-weight: bold;">1.0</span>, SVector(<span style="color: #de935f; font-weight: bold;">1.0</span>, <span style="color: #de935f; font-weight: bold;">1.0</span>))

    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">if</span> f1 <span style="color: #f0c674;">&gt;</span> f2
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> sdf_square_grad(x, <span style="color: #de935f; font-weight: bold;">1.0</span>, SVector(<span style="color: #de935f; font-weight: bold;">0.0</span>, <span style="color: #de935f; font-weight: bold;">0.0</span>))
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">elseif</span> f2 <span style="color: #f0c674;">&gt;</span> f1
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> <span style="color: #f0c674;">-</span>sdf_square_grad(x, <span style="color: #de935f; font-weight: bold;">1.0</span>, SVector(<span style="color: #de935f; font-weight: bold;">1.0</span>, <span style="color: #de935f; font-weight: bold;">1.0</span>))  <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">negative because of the minus</span>
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">else</span>
        <span style="color: var(--clr-comment-delimiter); background-color: var(--bg-comment-delimiter);"># </span><span style="color: var(--clr-comment); background-color: var(--bg-comment);">Subgradient &#8212; average of both directions</span>
        g1 = sdf_square_grad(x, <span style="color: #de935f; font-weight: bold;">1.0</span>, SVector(<span style="color: #de935f; font-weight: bold;">0.0</span>, <span style="color: #de935f; font-weight: bold;">0.0</span>))
        g2 = <span style="color: #f0c674;">-</span>sdf_square_grad(x, <span style="color: #de935f; font-weight: bold;">1.0</span>, SVector(<span style="color: #de935f; font-weight: bold;">1.0</span>, <span style="color: #de935f; font-weight: bold;">1.0</span>))
        <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">return</span> normalize(g1 <span style="color: #f0c674;">+</span> g2)
    <span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
<span style="color: var(--clr-keyword); background-color: var(--bg-keyword);">end</span>
</pre>
</div></div>
</div>
</div>
</div>
<div id="postamble" class="status">
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
if (!document.cookie.split('; ').find(r => r.startsWith('mode'))) {
document.cookie = 'mode=dark'
}
document.cookie = 'light=doom-plain'
document.cookie = 'dark=doom-tomorrow-night'
/*
;; nice-org-html.js
;;==============================================================================
;; Copyright (C) 2024, Ewan Townshend

;; Author: Ewan Townshend
;; URL: https://github.com/ewantown/nice-org-html
;; Version: 1.2

;;==============================================================================
;; This program is free software; you can redistribute it and/or modify
;; it under the terms of the GNU General Public License as published by
;; the Free Software Foundation, either version 3 of the License, or
;; (at your option) any later version.

;; This program is distributed in the hope that it will be useful,
;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;; GNU General Public License for more details.

;; You should have received a copy of the GNU General Public License
;; along with this program.  If not, see <https://www.gnu.org/licenses/>.

;; This file is not part of emacs.

;;==============================================================================
;; JS for html exported by et-org-html.el
 */

const preamble = document.getElementById("preamble");
const content = document.getElementById("content");
const postamble = document.getElementById("postamble");

const controls = document.getElementById("view-controls");
const toggleTocBtn = document.getElementById("toggle-toc");
const gotoTopBtn = document.getElementById("goto-top");
const toggleModeBtn = document.getElementById("toggle-mode");
const toc = document.getElementById("table-of-contents");

// Get and parse options passed in cookie string
const optCookie = document.cookie.split('; ').find(r => r.startsWith('options'));
const options = {};
if (optCookie) {
  optCookie.split('=')[1].split('__').forEach(pair => {
    const [key, val] = pair.split(':');
    if (key && val) {
      options[key] = val;
    }
  })
}

// Move sticky control bar (injected within preamble)
document.body.insertBefore(controls, content);

// Mode handling
function getMode() {
  let cookie = document.cookie.split('; ').find(r => r.startsWith('mode'))
  return cookie && cookie.split("=")[1];
}

function setMode(mode) {
  document.body.dataset.mode = mode;
  let thmCookie = document.cookie.split('; ').find(r => r.startsWith(mode));
  document.body.dataset.theme = thmCookie ? thmCookie.split('=')[1] : 'unknown';
  toggleModeBtn.innerHTML = (mode === 'light') ? '&#9789;' : '&#9788;';
  document.cookie = 'mode=' + mode;
}

// Initially, set mode based on stored cookie
let mode = getMode();
if (mode && ["light", "dark"].includes(mode)) {
  setMode(mode);
} else {  
  let prop = "prefers-color-scheme";
  let pref = (mode === "query") && window.matchMedia &&
    ["light", "dark"].find(s => window.matchMedia(`(${prop}: ${s})`).matches);
  setMode(pref || "dark"); // fallback: dark
}

// Mode toggling
toggleModeBtn.addEventListener('click', () => {
  setMode(document.body.dataset.mode === 'dark' ? 'light' : 'dark');
})


// Jump to top
let scrollY = document.documentElement.scrollTop;
window.addEventListener('scroll', () => {
  let atTop = document.documentElement.scrollTop <= preamble.offsetHeight;
  gotoTopBtn.dataset.show = !atTop + "";
});
gotoTopBtn.addEventListener('click', () => {
  window.scrollTo({
    top: 0,
    behavior: "smooth"
  });
})

// Table-of-contents toggling
if (toc) {
  toggleTocBtn.dataset.show = 'true';
  toggleTocBtn.addEventListener('click', () => {
    let showingToc = document.body.dataset.toc;
    scrollY = showingToc ? scrollY : document.documentElement.scrollTop;
    if (showingToc) {
      document.body.dataset.toc = '';
      document.documentElement.scrollTop = scrollY;
    } else {
      let tocHeight =
	Math.max(
	  window.innerHeight - controls.offsetHeight,
	  toc.offsetHeight
	);
      const header = document.getElementById("injected-header");
      if (header && (scrollY > header.offsetHeight)) {
	document.documentElement.scrollTop = preamble.offsetHeight;
      }
      toc.style.height = `${tocHeight}px`;
      document.body.dataset.toc = 'true';
    }
    toc.addEventListener('click', () => {
      if (document.body.dataset.toc) {
	document.body.dataset.toc = '';
	document.documentElement.scrollTop = scrollY;
      }
    })
  })
};

// Instrument anchor linking for sticky control bar
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', (e) => {
    e.preventDefault();
    const targetId = e.currentTarget.getAttribute('href');
    const target = document.querySelector(targetId);

    setTimeout(() => {
      const targetPos = target.getBoundingClientRect().top;
      let offset = targetPos + document.documentElement.scrollTop;
      offset -= controls.offsetHeight;
      window.scrollTo({
	top: offset,
	behavior: "smooth"
      });
    }, 0);
  });
});

function copyTextToClipboard(text) {
  // Make invisible textarea
  var textArea = document.createElement("textarea");
  textArea.style.position = 'fixed';
  textArea.style.top = 0;
  textArea.style.left = 0;
  textArea.style.width = '2em';
  textArea.style.height = '2em';
  textArea.style.padding = 0;
  textArea.style.border = 'none';
  textArea.style.outline = 'none';
  textArea.style.boxShadow = 'none';
  textArea.style.background = 'transparent';

  // Copy contents into it
  textArea.value = text;

  // Try to copy from it to clipboard
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();
  var res;
  try {
    res = document.execCommand('copy');
  } catch (err) {
    res = false;
  }

  // Remove invisible textarea
  document.body.removeChild(textArea);

  return res;
}

// Handle the default header / footer drawers
const header = document.getElementById("generated-header");
const footer = document.getElementById("generated-footer");

if (header) {
  let toggle = header.querySelector("header nav input.nav-toggle");
  if (toggle) { toggle.checked = false; }
}
if (footer) {
  let nav = footer.querySelector("nav");
  let toggle = nav && nav.querySelector(".nav-toggle");
  let navList = nav && nav.querySelector(".nav-list");
  let navElem = navList && [...navList.querySelectorAll(".nav-item")];
  let numLink = navElem && navElem.length;
  if (numLink) {
    toggle.checked = false;
    toggle.addEventListener('change', () => {
      if (toggle.checked) {
	setTimeout(() => window.scrollTo({
	  behavior: 'smooth',
	  top: document.body.scrollHeight	  
	}), 88);
      }
   });
  }
}

function autoCompact() {
  var anchor, links, overlap, trivial;
  const domCompute = (node) => {
    if (node) {
      anchor = node.querySelector('.nav-title, .nav-author');
      links = node.querySelector('.nav-list');
      overlap = links.offsetLeft - 5 <= anchor.offsetLeft + anchor.offsetWidth;	
      trivial = links.offsetLeft === anchor.offsetLeft;
    }
  };
  let mediaMatch = window.matchMedia('(max-width: 768px)').matches;
  [header, footer].forEach(e => {
    if (e) {
      if (mediaMatch) {
	e.classList.add('compact');
      } else {
	domCompute(e);
	if (overlap && !trivial) {
	  e.classList.add('compact');
	} else {	
	  let clone = e.cloneNode(true);
	  clone.style.top = '-2000px';
	  clone.style.maxHeight = '0px';
	  clone.classList.remove('compact');
	  e.parentNode.insertBefore(clone, e);
	  domCompute(clone);
	  let toggle = e.querySelector('.nav-toggle');
	  if (!overlap && toggle && !toggle.checked) {
	    e.classList.remove('compact');
	  }
	  e.parentNode.removeChild(clone);
	}
      }
    }
  })
}

if ((header || footer)) {
  if (options.hasOwnProperty('layout')) {
    [header, footer].forEach(e => e ? e.classList.add(options.layout) : null);
  } else {
    autoCompact();
    window.addEventListener('resize', autoCompact);
  }
}

if (options.hasOwnProperty('src-lang') && options['src-lang'] == 't') {
  let labels = [...document.querySelectorAll('.srcLangLabel')];
  labels.forEach(l => l.style.display = 'inline-block');
}

if (options.hasOwnProperty('collapsing') && options.collapsing == 't') {
  let levels = [2, 3, 4, 5, 6];
  let containerPrefix = 'outline-container-';
  levels.forEach(l => {
    let containers = [...document.querySelectorAll(`.outline-${l}`)];
    containers.forEach(c => {
      let id = c.id.slice(containerPrefix.length);
      let headline = document.getElementById(id);
      let siblings = [...c.children].filter(child => child.id != id);
      headline.classList.add('collapsible');
      headline.addEventListener('click', () => {	
	if (headline.classList.contains('collapsed')) {
	  headline.classList.remove('collapsed');
	  siblings.forEach(child => {
	    child.classList.remove('hidden');
	  });	  
	} else {
	  headline.classList.add('collapsed');
	  siblings.forEach(child => {
	    child.classList.add('hidden');
	  });
	}
      })
    })
  })
}
/*]]>*/-->
</script><div hidden>Generated by: https://github.com/ewantown/nice-org-html</div>
</div>
</body>
</html>
